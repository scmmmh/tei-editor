{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/AriaMenubar.vue?7305","webpack:///./src/App.vue?e199","webpack:///./src/components/TeiEditor.vue?20b9","webpack:///./src/components/AriaMenubar.vue","webpack:///./src/components/AriaMenubar.vue?8172","webpack:///./src/components/AriaMenubar.vue?133a","webpack:///./src/components/AriaMenu.vue","webpack:///./src/components/AriaMenu.vue?9d09","webpack:///./src/components/AriaMenu.vue?0c95","webpack:///./src/components/MetadataEditor.vue?debd","webpack:///./src/components/MetadataField.vue?d0b1","webpack:///./src/util/get.ts","webpack:///./src/components/MetadataField.vue","webpack:///./src/components/MetadataField.vue?1d8a","webpack:///./src/components/MetadataField.vue?8461","webpack:///./src/components/MetadataEditor.vue","webpack:///./src/components/MetadataEditor.vue?9aaf","webpack:///./src/components/MetadataEditor.vue?4d47","webpack:///./src/components/TextEditor.vue?26e2","webpack:///./src/util/deepclone.ts","webpack:///./src/util/prosemirror.ts","webpack:///./src/components/TextEditor.vue","webpack:///./src/components/TextEditor.vue?c156","webpack:///./src/components/TextEditor.vue?0156","webpack:///./src/util/TEISerialiser.ts","webpack:///./src/components/TeiEditor.vue","webpack:///./src/components/TeiEditor.vue?35b0","webpack:///./src/components/TeiEditor.vue?91c6","webpack:///./src/App.vue","webpack:///./src/App.vue?0ab4","webpack:///./src/App.vue?bff9","webpack:///./src/util/XPathEvaluator.ts","webpack:///./src/util/TEIMetadataParser.ts","webpack:///./src/util/TEITextParser.ts","webpack:///./src/store/index.ts","webpack:///./src/main.ts","webpack:///./src/components/TeiEditor.vue?7c95"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","scopedSlots","_u","fn","ref","keyboardNav","mouseClickNav","hasSaveCallback","hasLoadCallback","on","_v","$event","load","_e","save","_l","section","idx","currentSection","setCurrentSection","_s","label","sectionName","index","type","$scopedSlots","default","keyboardNavigation","mouseClickNavigation","ev","target","keyCode","next","findNextMenuitem","getParentMenubar","focus","parentElement","children","element","getAttribute","setAttribute","click","root","start","direction","stack","current","pop","injectStyles","context","locals","getParentMenu","parentMenu","getParentMenuOrMenubar","staticClass","config","entry","idx2","domProps","update","parent","path","modifyMenuItems","menuAction","obj","pathElements","split","Number","parseInt","substring","addMenuItems","action","$store","commit","$props","disabled","entries","forEach","indexOf","move","state","content","settings","metadataSection","components","AriaMenubar","props","String","MetadataField","block","class","active","menuitem","idx3","tabindex","ariaLabel","checked","closeNestedAction","nestedSettings","id","closeNestedEditor","deepclone","undefined","Array","isArray","map","val","clone","keys","generateSchemaNodes","schema","nodes","doc","group","parseDOM","tag","node","getAttrs","dom","toDOM","attributes","text","inline","generateSchemaMarks","marks","mark","getMarkRange","$pos","childAfter","parentOffset","link","find","startIndex","startPos","offset","endIndex","endPos","nodeSize","isInSet","child","childCount","from","to","updateMark","dispatch","tr","selection","$from","empty","range","hasMark","rangeHasMark","removeMark","addMark","updateInlineNode","replaceRangeWith","pos","wrapNode","wrappingType","contentType","$to","blockRange","setBlockType","wrap","unwrapNode","lift","isWrappedNode","editorSchema","editor","showNested","internalContentUpdate","stateDebounce","component","$el","querySelector","nodeFromJSON","plugins","editorPlugins","dispatchTransaction","transaction","newState","stateChanged","nestedSection","nestedId","toJSON","updateState","destroy","newValue","clearTimeout","setTimeout","nodesBetween","steps","menuItem","event","nodeType","isInline","nodeCallback","isBlock","walkFragment","textContent","fragment","replaceSelection","openStart","openEnd","isText","isWrappingType","contentNodeType","attr","targetNodeType","nestedDocs","nested","callback","replaceChild","typeName","sections","ui","blockSchema","condition","activeType","entities","entitySchema","elementSchema","entity","markType","values","nestedDocIds","nestedIds","nestedKey","docObj","docKey","Function","mergeTrees","serialiseHeader","serialiseSingleText","lines","toString","join","base","merge","found","objectsMatch","a","b","keysA","keysB","rootPath","serialiser","item","serialiseTextNode","ids","Set","nodeSchema","filter","part","replace","temp","markObjs","markSchema","markObj","size","sort","concat","tmpObj","subChild","reference","serialiseMetadataNode","multiple","items","_text","_attrs","indentation","xmlSafe","txt","buffer","callbacks","serialise","AriaMenu","MetadataEditor","TextEditor","configElement","document","getElementById","JSON","parse","innerHTML","autoLoad","sourceData","TeiEditor","nsResolver","prefix","xpath","result_type","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","ORDERED_NODE_ITERATOR_TYPE","STRING_TYPE","stringValue","BOOLEAN_TYPE","booleanValue","NUMBER_TYPE","numberValue","header","firstNode","documentElement","parseHeaderNode","elements","nodeIterator","iterateNext","parser","selector","tmp","parseContentNode","nestedDoc","addNestedDoc","parsers","e","console","log","parseContentAttributes","parseContentMarks","nestedParent","use","defaultState","Store","mutations","init","set","TEIEditor","setMetadata","metadata","setMetadataValue","payload","pathElement","pathIndex","addMetadataMuliRow","removeMetadataMultiRow","moveMetadataMultiRow","setTextDoc","actions","domParser","DOMParser","parseFromString","docs","productionTip","store","render","h","$mount"],"mappings":"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","file":"js/app.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-0-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-0-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-0-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AriaMenubar.vue?vue&type=style&index=0&module=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-0-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-0-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-0-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AriaMenubar.vue?vue&type=style&index=0&module=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('tei-editor')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"tei-editor\"}},[_c('nav',[_c('aria-menubar',{scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar keyboardNav = ref.keyboardNav;\nvar mouseClickNav = ref.mouseClickNav;\nreturn [_c('ul',{attrs:{\"role\":\"menubar\"}},[(_vm.hasSaveCallback || _vm.hasLoadCallback)?_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":\"0\",\"aria-expanded\":\"false\"},on:{\"keyup\":keyboardNav,\"click\":mouseClickNav}},[_vm._v(\"File\")]),_c('aria-menu',{scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar keyboardNav = ref.keyboardNav;\nvar mouseClickNav = ref.mouseClickNav;\nreturn [_c('ul',{attrs:{\"role\":\"menu\",\"aria-hidden\":\"true\"}},[(_vm.hasLoadCallback)?_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":\"-1\"},on:{\"click\":function($event){mouseClickNav($event); _vm.load()},\"keyup\":keyboardNav}},[_vm._v(\"Load\")])]):_vm._e(),(_vm.hasSaveCallback)?_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":\"-1\"},on:{\"click\":function($event){mouseClickNav($event); _vm.save()},\"keyup\":keyboardNav}},[_vm._v(\"Save\")])]):_vm._e()])]}}],null,true)})],1):_vm._e(),_vm._l((_vm.sections),function(section,key,idx){return _c('li',{key:idx,attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":\"-1\",\"aria-checked\":(key === _vm.currentSection) ? 'true' : 'false'},on:{\"click\":function($event){mouseClickNav($event); _vm.setCurrentSection(key)},\"keyup\":keyboardNav}},[_vm._v(_vm._s(section.label))])])})],2)]}}])})],1),_c('div',[_vm._l((_vm.sections),function(section,sectionName,index){return [(sectionName === _vm.currentSection)?[(section.type === 'MetadataEditor')?_c('metadata-editor',{key:index,attrs:{\"config\":section}}):_vm._e(),(section.type === 'TextEditor')?_c('text-editor',{key:index,attrs:{\"section\":sectionName}}):_vm._e()]:_vm._e()]})],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport { Component, Vue } from 'vue-property-decorator';\n\n\n@Component({\n})\nexport default class AriaMenubar extends Vue {\n    public render() {\n        if (this.$scopedSlots.default) {\n            return this.$scopedSlots.default({\n                keyboardNav: this.keyboardNavigation,\n                mouseClickNav: this.mouseClickNavigation,\n            });\n        }\n    }\n\n    public keyboardNavigation(ev: KeyboardEvent) {\n        let target = ev.target as HTMLElement;\n        if (target) {\n            if (ev.keyCode === 39) {\n                let next = this.findNextMenuitem(this.getParentMenubar(target), target, 'next');\n                if (next) {\n                    next.focus();\n                }\n            } else if (ev.keyCode === 37) {\n                let next = this.findNextMenuitem(this.getParentMenubar(target), target, 'previous');\n                if (next) {\n                    next.focus();\n                }\n            } else if (ev.keyCode === 38 || ev.keyCode === 40) {\n                // @ts-ignore\n                for (const element of target.parentElement.children) {\n                    if (element.getAttribute('role') === 'menu') {\n                        element.setAttribute('aria-hidden', 'false');\n                        target.setAttribute('aria-expanded', 'true');\n                        let next = this.findNextMenuitem(element as HTMLElement, null, 'next');\n                        if (next) {\n                            next.focus();\n                        }\n                    }\n                }\n            } else if (ev.keyCode === 13 || ev.keyCode == 32) {\n                // @ts-ignore\n                for (const element of target.parentElement.children) {\n                    if (element.getAttribute('role') === 'menu') {\n                        if (element.getAttribute('aria-hidden') === 'false') {\n                            element.setAttribute('aria-hidden', 'true');\n                            target.setAttribute('aria-expanded', 'false');\n                        } else {\n                            element.setAttribute('aria-hidden', 'false');\n                            target.setAttribute('aria-expanded', 'true');\n                            let next = this.findNextMenuitem(element as HTMLElement, null, 'next');\n                            if (next) {\n                                next.focus();\n                                return;\n                            }\n                        }\n                    }\n                }\n                target.click();\n            }\n        }\n    }\n\n    public mouseClickNavigation(ev: MouseEvent) {\n        let target = ev.target as HTMLElement;\n        if (target) {\n            // @ts-ignore\n            for (const element of target.parentElement.children) {\n                if (element.getAttribute('role') === 'menu') {\n                    if (element.getAttribute('aria-hidden') === 'false') {\n                        element.setAttribute('aria-hidden', 'true');\n                        target.setAttribute('aria-expanded', 'false');\n                    } else {\n                        element.setAttribute('aria-hidden', 'false');\n                        target.setAttribute('aria-expanded', 'true');\n                        let next = this.findNextMenuitem(element as HTMLElement, null, 'next');\n                        if (next) {\n                            next.focus();\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    protected getParentMenubar(element: HTMLElement): HTMLElement | null {\n        if (!element) {\n            return null;\n        } else if (element.getAttribute('role') === 'menubar') {\n            return element;\n        } else {\n            return this.getParentMenubar(element.parentElement as HTMLElement);\n        }\n    }\n\n    protected findNextMenuitem(root: HTMLElement | null, start: HTMLElement | null, direction: string) {\n        if (!root) {\n            return null;\n        }\n        let stack = [] as HTMLElement[];\n        if (direction === 'next') {\n            for (let idx = root.children.length - 1; idx >= 0; idx--) {\n                stack.push(root.children[idx] as HTMLElement);\n            }\n        } else {\n            for (let idx = 0; idx < root.children.length; idx++) {\n                stack.push(root.children[idx] as HTMLElement);\n            }\n        }\n        let mode = 0;\n        if (!start) {\n            mode = 1;\n        }\n        while (stack.length > 0) {\n            let current = stack.pop() as HTMLElement;\n            if (mode === 0 && current === start) {\n                mode = 1;\n            } else if (mode === 1 && current.getAttribute('role') === 'menuitem' && current.getAttribute('aria-disabled') !== 'true') {\n                return current;\n            }\n            if (current.getAttribute('role') !== 'menu') {\n                if (direction === 'next') {\n                    for (let idx = current.children.length - 1; idx >= 0; idx--) {\n                        stack.push(current.children[idx] as HTMLElement);\n                    }\n                } else {\n                    for (let idx = 0; idx < current.children.length; idx++) {\n                        stack.push(current.children[idx] as HTMLElement);\n                    }\n                }\n            }\n        }\n        return null;\n    }\n}\n","var render, staticRenderFns\nimport script from \"./AriaMenubar.vue?vue&type=script&lang=ts&\"\nexport * from \"./AriaMenubar.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./AriaMenubar.vue?vue&type=style&index=0&module=true&lang=scss&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AriaMenubar.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AriaMenubar.vue?vue&type=script&lang=ts&\"","\nimport { Component } from 'vue-property-decorator';\nimport AriaMenubar from './AriaMenubar.vue';\n\n@Component({\n})\nexport default class AriaMenu extends AriaMenubar {\n    public render() {\n        if (this.$scopedSlots.default) {\n            return this.$scopedSlots.default({\n                keyboardNav: this.keyboardNavigation,\n                mouseClickNav: this.mouseClickNavigation,\n            });\n        }\n    }\n\n    public keyboardNavigation(ev: KeyboardEvent) {\n        let target = ev.target as HTMLElement;\n        if (target) {\n            if (ev.keyCode === 39) {\n            } else if (ev.keyCode === 37) {\n            } else if (ev.keyCode === 38) {\n                let next = this.findNextMenuitem(this.getParentMenu(target), target, 'previous');\n                if (next) {\n                    next.focus();\n                }\n            } else if (ev.keyCode === 40) {\n                let next = this.findNextMenuitem(this.getParentMenu(target), target, 'next');\n                if (next) {\n                    next.focus();\n                }\n            } else if (ev.keyCode === 13 || ev.keyCode == 32) {\n                if (target.getAttribute('aria-expanded')) {\n                    // @ts-ignore\n                    for (const element of target.parentElement.children) {\n                        if (element.getAttribute('role') === 'menu') {\n                            if (element.getAttribute('aria-hidden') === 'false') {\n                                element.setAttribute('aria-hidden', 'true');\n                                target.setAttribute('aria-expanded', 'false');\n                            } else {\n                                element.setAttribute('aria-hidden', 'false');\n                                target.setAttribute('aria-expanded', 'true');\n                                let next = this.findNextMenuitem(element as HTMLElement, null, 'next');\n                                if (next) {\n                                    next.focus();\n                                }\n                            }\n                        }\n                    }\n                } else {\n                    target.click();\n                }\n            } else if (ev.keyCode === 27) {\n                let parentMenu = this.getParentMenu(target);\n                if (parentMenu) {\n                    parentMenu.setAttribute('aria-hidden', 'true');\n                    // @ts-ignore\n                    for (const element of parentMenu.parentElement.children) {\n                        if (element.getAttribute('role') === 'menuitem') {\n                            element.setAttribute('aria-expanded', 'false');\n                            (element as HTMLElement).focus();\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    public mouseClickNavigation(ev: MouseEvent) {\n        let target = ev.target as HTMLElement;\n        if (target) {\n            if (target.getAttribute('aria-expanded')) {\n                // @ts-ignore\n                for (const element of target.parentElement.children) {\n                    if (element.getAttribute('role') === 'menu') {\n                        if (element.getAttribute('aria-hidden') === 'false') {\n                            element.setAttribute('aria-hidden', 'true');\n                            target.setAttribute('aria-expanded', 'false');\n                        } else {\n                            element.setAttribute('aria-hidden', 'false');\n                            target.setAttribute('aria-expanded', 'true');\n                            let next = this.findNextMenuitem(element as HTMLElement, null, 'next');\n                            if (next) {\n                                next.focus();\n                            }\n                        }\n                    }\n                }\n            } else {\n                let parentMenu = this.getParentMenu(target);\n                if (parentMenu) {\n                    parentMenu.setAttribute('aria-hidden', 'true');\n                    // @ts-ignore\n                    for (const element of parentMenu.parentElement.children) {\n                        if (element.getAttribute('role') === 'menuitem') {\n                            element.setAttribute('aria-expanded', 'false');\n                            (element as HTMLElement).focus();\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    protected getParentMenu(element: HTMLElement): HTMLElement | null {\n        if (!element) {\n            return null;\n        } else if (element.getAttribute('role') === 'menu') {\n            return element;\n        } else {\n            return this.getParentMenu(element.parentElement as HTMLElement);\n        }\n    }\n\n    protected getParentMenuOrMenubar(element: HTMLElement): HTMLElement | null {\n        if (!element) {\n            return null;\n        } else if (element.getAttribute('role') === 'menu' || element.getAttribute('role') === 'menubar') {\n            return element;\n        } else {\n            return this.getParentMenuOrMenubar(element.parentElement as HTMLElement);\n        }\n    }\n}\n","var render, staticRenderFns\nimport script from \"./AriaMenu.vue?vue&type=script&lang=ts&\"\nexport * from \"./AriaMenu.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AriaMenu.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AriaMenu.vue?vue&type=script&lang=ts&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"metadata-editor\"},_vm._l((_vm.config.ui),function(section,idx){return _c('section',{key:idx},[_c('h2',[_vm._v(_vm._s(section.label))]),_vm._l((section.entries),function(entry,idx2){return _c('div',{key:idx2},[_c('metadata-field',{attrs:{\"config\":entry}})],1)})],2)}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.config.type == 'single-text')?[_c('label',[_c('span',{staticClass:\"label-text\"},[_vm._v(_vm._s(_vm.config.label))]),_c('input',{attrs:{\"type\":\"text\"},domProps:{\"value\":_vm.value},on:{\"change\":_vm.update}})])]:_vm._e(),(_vm.config.type == 'multi-row')?[_c('ol',{staticClass:\"multi-row\"},_vm._l((_vm.value),function(data,idx){return _c('li',{key:idx},[_vm._l((_vm.config.entries),function(entry,idx2){return _c('metadata-field',{key:idx2,attrs:{\"config\":entry,\"parent\":_vm.parent + _vm.config.path + '.[' + idx + ']'}})}),_c('aria-menubar',{attrs:{\"items\":_vm.modifyMenuItems(idx)},on:{\"action\":_vm.menuAction}}),_c('aria-menubar',{scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar keyboardNav = ref.keyboardNav;\nreturn [_c('ul',{attrs:{\"role\":\"menubar\"}},[_c('li',{attrs:{\"role\":\"presentation\"}},[(idx === 0)?_c('a',{attrs:{\"role\":\"menuitem\",\"aria-disabled\":true}},[_c('svg',{attrs:{\"viewBox\":\"0 0 24 24\",\"aria-label\":\"Move up\"}},[_c('path',{attrs:{\"d\":\"M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M16.59,15.71L12,11.12L7.41,15.71L6,14.29L12,8.29L18,14.29L16.59,15.71Z\"}})])]):_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":_vm.value.length === 1 ? null : 0},on:{\"click\":function($event){return _vm.menuAction('move-up:' + idx)},\"keyup\":keyboardNav}},[_c('svg',{attrs:{\"viewBox\":\"0 0 24 24\",\"aria-label\":\"Move up\"}},[_c('path',{attrs:{\"d\":\"M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M16.59,15.71L12,11.12L7.41,15.71L6,14.29L12,8.29L18,14.29L16.59,15.71Z\"}})])])]),_c('li',{attrs:{\"role\":\"presentation\"}},[(idx === _vm.value.length - 1)?_c('a',{attrs:{\"role\":\"menuitem\",\"aria-disabled\":true}},[_c('svg',{attrs:{\"viewBox\":\"0 0 24 24\",\"aria-label\":\"Move down\"}},[_c('path',{attrs:{\"d\":\"M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M12,15.71L6,9.71L7.41,8.29L12,12.88L16.59,8.29L18,9.71L12,15.71Z\"}})])]):_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":_vm.value.length === 1 ? null : 0},on:{\"click\":function($event){return _vm.menuAction('move-down:' + idx)},\"keyup\":keyboardNav}},[_c('svg',{attrs:{\"viewBox\":\"0 0 24 24\",\"aria-label\":\"Move down\"}},[_c('path',{attrs:{\"d\":\"M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M12,15.71L6,9.71L7.41,8.29L12,12.88L16.59,8.29L18,9.71L12,15.71Z\"}})])])]),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":_vm.value.length === 1 ? 0 : -1},on:{\"click\":function($event){return _vm.menuAction('delete:' + idx)},\"keyup\":keyboardNav}},[_c('svg',{attrs:{\"viewBox\":\"0 0 24 24\",\"aria-label\":\"Delete\"}},[_c('path',{attrs:{\"d\":\"M17,13H7V11H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z\"}})])])])])]}}],null,true)})],2)}),0),_c('aria-menubar',{scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar keyboardNav = ref.keyboardNav;\nreturn [_c('ul',{attrs:{\"role\":\"menubar\"}},[_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":\"0\"},on:{\"click\":function($event){return _vm.menuAction('add')},\"keyup\":keyboardNav}},[_c('svg',{attrs:{\"viewBox\":\"0 0 24 24\",\"aria-label\":\"Add\"}},[_c('path',{attrs:{\"d\":\"M17,13H13V17H11V13H7V11H11V7H13V11H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z\"}})])])])])]}}],null,false,3190783598)})]:_vm._e(),(_vm.config.type == 'multi-field')?[_c('ol',{staticClass:\"multi-field\"},_vm._l((_vm.config.entries),function(entry,idx){return _c('li',{key:idx},[_c('metadata-field',{attrs:{\"config\":entry,\"parent\":_vm.parent + _vm.config.path}})],1)}),0)]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default function get(obj: any, path: string) {\n    let pathElements = path.split('.');\n    while (obj && pathElements.length > 0) {\n        if (pathElements[0][0] === '[' && pathElements[0][pathElements[0].length - 1] === ']') {\n            let idx = Number.parseInt(pathElements[0].substring(1, pathElements[0].length - 1));\n            if (idx >= 0 && idx < obj.length) {\n                obj = obj[idx];\n            }\n        } else {\n            obj = obj[pathElements[0]];\n        }\n        pathElements = pathElements.slice(1);\n    }\n    return obj;\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport AriaMenubar from './AriaMenubar.vue';\nimport get from '@/util/get';\n\n\n@Component({\n    components: {\n        AriaMenubar,\n    },\n    props: {\n        config: Object,\n        parent: {\n            type: String,\n            default: '',\n        },\n    },\n    name: 'metadata-field',\n})\nexport default class MetadataField extends Vue {\n    addMenuItems = [\n        {\n            label: '<svg viewBox=\"0 0 24 24\" aria-label=\"Add\"><path d=\"M17,13H13V17H11V13H7V11H11V7H13V11H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z\" /></svg>',\n            action: 'add',\n        },\n    ];\n\n    get value() {\n        // eslint-disable-next-line\n        let value = get(this.$store.state.content[this.$store.state.settings.metadataSection], this.$props.parent + this.$props.config.path);\n        if (value) {\n            return value;\n        } else {\n            return '';\n        }\n    }\n\n    public update(ev: Event) {\n        if (ev && ev.target) {\n            this.$store.commit('setMetadataValue', {path: this.$props.parent + this.$props.config.path, value: (ev.target as HTMLInputElement).value});\n        }\n    }\n\n    public modifyMenuItems(idx: number) {\n        return [\n            {\n                label: '<svg viewBox=\"0 0 24 24\" aria-label=\"Move up\"><path d=\"M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M16.59,15.71L12,11.12L7.41,15.71L6,14.29L12,8.29L18,14.29L16.59,15.71Z\" /></svg>',\n                action: 'move-up:' + idx,\n                disabled: idx === 0,\n            },\n            {\n                label: '<svg viewBox=\"0 0 24 24\" aria-label=\"Move down\"><path d=\"M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M12,15.71L6,9.71L7.41,8.29L12,12.88L16.59,8.29L18,9.71L12,15.71Z\" /></svg>',\n                action: 'move-down:' + idx,\n                disabled: idx === this.value.length - 1,\n            },\n            {\n                label: '<svg viewBox=\"0 0 24 24\" aria-label=\"Delete\"><path d=\"M17,13H7V11H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z\" /></svg>',\n                action: 'delete:' + idx,\n            },\n        ];\n    }\n\n    public menuAction(name: string) {\n        if (name === 'add') {\n            // Construct the empty data structure for the new value to add\n            let value = {} as any;\n            this.$props.config.entries.forEach((entry: any) => {\n                let path = entry.path;\n                if (path[0] === '.') {\n                    path = path.substring(1);\n                }\n                if (entry.type === 'single-text') {\n                    value[path] = '';\n                } else if (entry.type === 'multi-row') {\n                    value[path] = [];\n                } else if (entry.type === 'multi-field') {\n                    entry.entries.forEach((entry: any) => {\n                        let path = entry.path;\n                        if (path[0] === '.') {\n                            path = path.substring(1);\n                        }\n                        if (entry.type === 'single-text') {\n                            value[path] = '';\n                        } else if (entry.type === 'multi-row') {\n                            value[path] = [];\n                        }\n                    });\n                }\n            });\n            this.$store.commit('addMetadataMuliRow', {\n                path: this.$props.parent + this.$props.config.path,\n                value: value,\n            })\n        } else if (name.indexOf('move-up:') === 0) {\n            this.$store.commit('moveMetadataMultiRow', {\n                path: this.$props.parent + this.$props.config.path,\n                idx: Number.parseInt(name.substring(8)),\n                move: -1,\n            });\n        } else if (name.indexOf('move-down:') === 0) {\n            this.$store.commit('moveMetadataMultiRow', {\n                path: this.$props.parent + this.$props.config.path,\n                idx: Number.parseInt(name.substring(10)),\n                move: 1,\n            });\n        } else if (name.indexOf('delete:') === 0) {\n            this.$store.commit('removeMetadataMultiRow', {\n                path: this.$props.parent + this.$props.config.path,\n                value: Number.parseInt(name.substring(7))\n            })\n        }\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataField.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataField.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MetadataField.vue?vue&type=template&id=6db4f44b&\"\nimport script from \"./MetadataField.vue?vue&type=script&lang=ts&\"\nexport * from \"./MetadataField.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport MetadataField from './MetadataField.vue';\n\n@Component({\n    components: {\n        MetadataField,\n    },\n    props: {\n        config: Object,\n    }\n})\nexport default class MetadataEditor extends Vue {\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataEditor.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataEditor.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MetadataEditor.vue?vue&type=template&id=4a0150ce&\"\nimport script from \"./MetadataEditor.vue?vue&type=script&lang=ts&\"\nexport * from \"./MetadataEditor.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"text-editor\"},[_c('div',{staticClass:\"editor\"}),_c('aria-menubar',{scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar keyboardNav = ref.keyboardNav;\nreturn [_c('div',{staticClass:\"sidebar\"},_vm._l((_vm.sidebar),function(block,idx){return _c('div',{key:idx,class:{'is-active': block.active}},[_c('h2',[_vm._v(_vm._s(block.label))]),_vm._l((block.entities),function(section,idx2){return [(section.type === 'list')?_c('ul',{key:idx2},_vm._l((section.entities),function(menuitem,idx3){return _c('li',{key:idx3,attrs:{\"role\":\"presentation\"}},[_c('label',[_c('span',{domProps:{\"innerHTML\":_vm._s(menuitem.label)}}),(menuitem.type === 'setNodeAttrString')?_c('input',{domProps:{\"value\":menuitem.value},on:{\"change\":function($event){return _vm.menuAction(menuitem, $event)}}}):_vm._e()])])}),0):(section.type === 'menubar')?_c('ul',{key:idx2,attrs:{\"role\":\"menubar\"}},_vm._l((section.entities),function(menuitem,idx3){return _c('li',{key:idx3,class:menuitem.type === 'separator' ? 'separator' : null,attrs:{\"role\":\"presentation\"}},[(menuitem.type === 'setNodeType')?_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":menuitem.tabindex,\"aria-label\":menuitem.ariaLabel,\"title\":menuitem.ariaLabel,\"aria-checked\":menuitem.checked},domProps:{\"innerHTML\":_vm._s(menuitem.label)},on:{\"keyup\":keyboardNav,\"click\":function($event){return _vm.menuAction(menuitem)}}}):(menuitem.type === 'setNodeAttrValue')?_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":menuitem.tabindex,\"aria-label\":menuitem.ariaLabel,\"title\":menuitem.ariaLabel,\"aria-checked\":menuitem.checked},domProps:{\"innerHTML\":_vm._s(menuitem.label)},on:{\"keyup\":keyboardNav,\"click\":function($event){return _vm.menuAction(menuitem)}}}):(menuitem.type === 'selectNodeAttr')?_c('select',{attrs:{\"role\":\"menuitem\",\"tabindex\":menuitem.tabindex},on:{\"keyup\":keyboardNav,\"change\":function($event){return _vm.menuAction(menuitem, $event)}}},_vm._l((menuitem.values),function(value){return _c('option',{key:value.value,domProps:{\"value\":value.value,\"selected\":value.checked,\"innerHTML\":_vm._s(value.label)}})}),0):(menuitem.type === 'toggleMark')?_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":menuitem.tabindex,\"aria-label\":menuitem.ariaLabel,\"title\":menuitem.ariaLabel,\"aria-checked\":menuitem.checked},domProps:{\"innerHTML\":_vm._s(menuitem.label)},on:{\"keyup\":keyboardNav,\"click\":function($event){return _vm.menuAction(menuitem)}}}):(menuitem.type === 'selectMarkAttr')?_c('select',{attrs:{\"role\":\"menuitem\",\"tabindex\":menuitem.tabindex},on:{\"keyup\":keyboardNav,\"change\":function($event){return _vm.menuAction(menuitem, $event)}}},_vm._l((menuitem.values),function(value){return _c('option',{key:value.value,domProps:{\"value\":value.value,\"selected\":value.checked,\"innerHTML\":_vm._s(value.label)}})}),0):(menuitem.type === 'editNestedDoc')?_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":menuitem.tabindex,\"aria-label\":menuitem.ariaLabel,\"title\":menuitem.ariaLabel},domProps:{\"innerHTML\":_vm._s(menuitem.label)},on:{\"keyup\":keyboardNav,\"click\":function($event){return _vm.menuAction(menuitem)}}}):(menuitem.type === 'closeNested')?_c('a',{attrs:{\"role\":\"menuitem\",\"tabindex\":menuitem.tabindex,\"aria-label\":menuitem.ariaLabel,\"title\":menuitem.ariaLabel},domProps:{\"innerHTML\":_vm._s(menuitem.label)},on:{\"keyup\":keyboardNav,\"click\":_vm.closeNestedAction}}):(menuitem.type === 'linkNestedDoc')?_c('select',{attrs:{\"role\":\"menuitem\",\"tabindex\":menuitem.tabindex},on:{\"keyup\":keyboardNav,\"change\":function($event){return _vm.menuAction(menuitem, $event)}}},_vm._l((menuitem.values),function(value){return _c('option',{key:value.value,domProps:{\"value\":value.value,\"selected\":value.checked,\"innerHTML\":_vm._s(value.label)}})}),0):_vm._e()])}),0):_vm._e()]})],2)}),0)]}}])}),(_vm.showNested)?_c('div',{staticClass:\"nested\"},[_c('text-editor',{attrs:{\"section\":_vm.section,\"nestedSection\":_vm.nestedSettings.section,\"nestedId\":_vm.nestedSettings.id,\"closeNestedAction\":_vm.closeNestedEditor}})],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * Performs a deep cloning of the first element of the parameters.\n */\nexport default function deepclone(obj: any): any {\n    if (obj === undefined) {\n        return undefined;\n    } else if (obj === null) {\n        return null;\n    } else if (Array.isArray(obj)) {\n        return obj.map((val) => {\n            return deepclone(val);\n        });\n    } else if (typeof(obj) === 'object') {\n        let clone = <any>{};\n        Object.keys(obj).forEach(function(key) {\n            clone[key] = deepclone(obj[key]);\n        });\n        return clone;\n    } else {\n        return obj;\n    }\n}\n","import { Schema, NodeSpec, MarkSpec, MarkType, NodeType, Mark, ResolvedPos } from 'prosemirror-model';\nimport { EditorState, Transaction } from 'prosemirror-state';\nimport { findSelectedNodeOfType, findParentNodeOfType } from 'prosemirror-utils';\nimport { liftTarget } from 'prosemirror-transform';\n\nimport { TextEditorNodeConfig } from '@/interfaces';\n\n/**\n * Generate the Prosemirror schema structure for nodes from the general node configuration.\n */\nexport function generateSchemaNodes(schema: TextEditorNodeConfig[]) {\n    const nodes = {\n        doc: {\n            content: 'block+',\n        }\n    } as { [x: string]: NodeSpec };\n    schema.forEach((config) => {\n        if (config.type === 'block') {\n            nodes[config.name] = {\n                content: 'inline*',\n                group: 'block',\n                attrs: config.attrs,\n                parseDOM: [{\n                    tag: `div.node-${config.name}`,\n                    node: config.name,\n                    getAttrs: (dom: Node | string) => {\n                        let attrs = {} as any;\n                        if (config.attrs) {\n                            Object.keys(config.attrs).forEach((key) => {\n                                let value = (dom as HTMLElement).getAttribute(`data-${key}`);\n                                if (value) {\n                                    attrs[key] = value;\n                                }\n                            });\n                        }\n                        return attrs;\n                    }\n                }],\n                toDOM: (node) => {\n                    let attributes = {\n                        class: `node-${config.name}`,\n                    } as any;\n                    Object.entries(node.attrs).forEach(([key, value]) => {\n                        attributes[`data-${key}`] = value;\n                    });\n                    return ['div', attributes, 0];\n                },\n            };\n        } else if (config.type === 'wrapping') {\n            nodes[config.name] = {\n                content: config.content + '+',\n                group: 'block',\n                attrs: config.attrs,\n                parseDOM: [{\n                    tag: `div.node-${config.name}`,\n                    getAttrs: (dom: Node | string) => {\n                        let attrs = {} as any;\n                        if (config.attrs) {\n                            Object.keys(config.attrs).forEach((key) => {\n                                let value = (dom as HTMLElement).getAttribute(`data-${key}`);\n                                if (value) {\n                                    attrs[key] = value;\n                                }\n                            });\n                        }\n                        return attrs;\n                    }\n                }],\n                toDOM: (node: any) => {\n                    let attributes = {\n                        class: `node-${config.name}`,\n                    } as any;\n                    Object.entries(node.attrs).forEach(([key, value]) => {\n                        attributes[`data-${key}`] = value;\n                    });\n                    return ['div', attributes, 0];\n                },\n            };\n        } else if (config.type === 'inline' && config.name === 'text') {\n            nodes.text = {\n                group: 'inline',\n            };\n        } else if (config.type === 'inline' && config.name !== 'text') {\n            nodes[config.name] = {\n                content: 'inline*',\n                group: 'inline',\n                inline: true,\n                attrs: config.attrs,\n                parseDOM: [{\n                    tag: `span.node-${config.name}`,\n                    getAttrs: (dom: Node | string) => {\n                        let attrs = {} as any;\n                        if (config.attrs) {\n                            Object.keys(config.attrs).forEach((key) => {\n                                let value = (dom as HTMLElement).getAttribute(`data-${key}`);\n                                if (value) {\n                                    attrs[key] = value;\n                                }\n                            });\n                        }\n                        return attrs;\n                    }\n                }],\n                toDOM: (node) => {\n                    let attributes = {\n                        class: `node-${config.name}`,\n                    } as any;\n                    Object.entries(node.attrs).forEach(([key, value]) => {\n                        attributes[`data-${key}`] = value;\n                    });\n                    return ['span', attributes, 0];\n                },\n            };\n        }\n    });\n    return nodes;\n}\n\n/**\n * Generate the Prosemirror schema structure for marks from the general node configuration.\n */\nexport function generateSchemaMarks(schema: TextEditorNodeConfig[]) {\n    const marks = {\n    } as { [x: string]: MarkSpec };\n    schema.forEach((config) => {\n        if (config.type === 'mark') {\n            marks[config.name] = {\n                attrs: config.attrs,\n                parseDOM: [\n                    {\n                        tag: `span.mark-${config.name}`,\n                        getAttrs: (dom: Node | string) => {\n                            let attrs = {} as any;\n                            if (config.attrs) {\n                                Object.keys(config.attrs).forEach((key) => {\n                                    let value = (dom as HTMLElement).getAttribute(`data-${key}`);\n                                    if (value) {\n                                        attrs[key] = value;\n                                    }\n                                });\n                            }\n                            return attrs;\n                        }\n                    },\n                ],\n                toDOM: (mark: any) => {\n                    let attributes = {\n                        class: `mark-${config.name}`,\n                    } as any;\n                    Object.entries(mark.attrs).forEach(([key, value]) => {\n                        if (value) {\n                            attributes[`data-${key}`] = value;\n                        }\n                    });\n                    return ['span', attributes, 0]\n                },\n            };\n        }\n    });\n    return marks;\n}\n\n/**\n * Calculate the full range of the given mark type.\n *\n * Taken from https://github.com/scrumpy/tiptap/blob/master/packages/tiptap-utils/src/utils/getMarkRange.js\n */\nexport function getMarkRange($pos: ResolvedPos, type: MarkType) {\n    if (!$pos || !type) {\n        return false;\n    }\n    const start = $pos.parent.childAfter($pos.parentOffset)\n    if (!start.node) {\n        return false;\n    }\n    const link = start.node.marks.find((mark: Mark) => { return mark.type === type; })\n    if (!link) {\n        return false;\n    }\n    let startIndex = $pos.index();\n    let startPos = $pos.start() + start.offset;\n    let endIndex = startIndex + 1;\n    let endPos = startPos + start.node.nodeSize;\n    while (startIndex > 0 && link.isInSet($pos.parent.child(startIndex - 1).marks)) {\n        startIndex -= 1;\n        startPos -= $pos.parent.child(startIndex).nodeSize;\n    }\n    while (endIndex < $pos.parent.childCount && link.isInSet($pos.parent.child(endIndex).marks)) {\n        endPos += $pos.parent.child(endIndex).nodeSize;\n        endIndex += 1;\n    }\n    return { from: startPos, to: endPos };\n}\n\n/**\n * Update the mark of the given type with the new attributes.\n */\nexport function updateMark(type: MarkType, attrs: {[x: string]: string}) {\n    return (state: EditorState, dispatch: (tr: Transaction) => void) => {\n        const { tr, selection, doc } = state;\n        let { from, to } = selection;\n        const { $from, empty } = selection;\n        if (empty) {\n            const range = getMarkRange($from, type)\n            if (range) {\n                from = range.from;\n                to = range.to;\n            }\n        }\n        const hasMark = doc.rangeHasMark(from, to, type)\n        if (hasMark) {\n            tr.removeMark(from, to, type)\n        }\n        tr.addMark(from, to, type.create(attrs))\n        return dispatch(tr);\n    }\n}\n\n/**\n * Remove the mark of the given type.\n */\nexport function removeMark(type: MarkType) {\n    return (state: EditorState, dispatch: (tr: Transaction) => void) => {\n        const { tr, selection, doc } = state;\n        let { from, to } = selection;\n        const { $from, empty } = selection;\n        if (empty) {\n            const range = getMarkRange($from, type)\n            if (range) {\n                from = range.from;\n                to = range.to;\n            }\n        }\n        const hasMark = doc.rangeHasMark(from, to, type)\n        if (hasMark) {\n            tr.removeMark(from, to, type)\n            return dispatch(tr);\n        }\n    }\n}\n\n/**\n * Update the inline node of the given type with the given attributes.\n */\nexport function updateInlineNode(type: NodeType, attrs: {[x: string]: string}) {\n    return (state: EditorState, dispatch: (tr: Transaction) => void) => {\n        const result = findSelectedNodeOfType(type)(state.selection) || findParentNodeOfType(type)(state.selection);\n        if (result) {\n            const tr = state.tr.replaceRangeWith(result.pos, result.pos + result.node.nodeSize, type.create(attrs, result.node.content));\n            dispatch(tr);\n        }\n    }\n}\n\n/**\n * Set the current block's type to contentType and then wrap it in the wrappingType block.\n */\nexport function wrapNode(wrappingType: NodeType, contentType: NodeType) {\n    return (state: EditorState, dispatch: (tr: Transaction) => void) => {\n        const { $from, $to } = state.selection;\n        const range = $from.blockRange($to);\n\n        if (range) {\n            let tr = state.tr.setBlockType(range.$from.pos, range.$to.pos, contentType);\n            tr = tr.wrap(range, [{type: wrappingType}]);\n            dispatch(tr);\n        } else {\n            return false;\n        }\n    }\n}\n\n/**\n * Unwrap the current wrapped node and set it to the given type.\n */\nexport function unwrapNode(type: NodeType) {\n    return (state: EditorState, dispatch: (tr: Transaction) => void) => {\n        const { $from, $to } = state.selection;\n        const range = $from.blockRange($to);\n        const target = range && liftTarget(range)\n\n        if (range && target !== null && target !== undefined) {\n            let tr = state.tr.lift(range, target);\n            tr = tr.setBlockType(range.$from.pos, range.$to.pos, type);\n            dispatch(tr);\n        } else {\n            return false;\n        }\n    }\n}\n\n/**\n * Test if the current node is inside a wrapping node type.\n */\nexport function isWrappedNode(state: EditorState, schema: any[], editorSchema: Schema) {\n    for (let idx = 0; idx < schema.length; idx++) {\n        if (schema[idx].type === 'wrapping') {\n            if (findParentNodeOfType(editorSchema.nodes[schema[idx].name])(state.selection)) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\nimport { Schema, Fragment, Slice, Node as ProsemirrorNode } from \"prosemirror-model\";\nimport { EditorState, Transaction } from \"prosemirror-state\";\nimport { EditorView } from \"prosemirror-view\";\nimport { baseKeymap, setBlockType, toggleMark } from 'prosemirror-commands';\nimport { undo, redo, history } from 'prosemirror-history';\nimport { keymap } from 'prosemirror-keymap';\n\nimport AriaMenubar from './AriaMenubar.vue';\nimport get from '@/util/get';\nimport deepclone from '@/util/deepclone';\nimport { generateSchemaNodes, generateSchemaMarks, updateMark, removeMark, updateInlineNode, wrapNode, unwrapNode, isWrappedNode } from '@/util/prosemirror';\nimport { TextEditorSidebarBlockConfig, TextEditorActiveElements, TextEditorMenuItem, TextEditorMenuItemValuesValue } from '@/interfaces';\n\n@Component({\n    components: {\n        AriaMenubar,\n    },\n    name: 'text-editor',\n})\nexport default class TextEditor extends Vue {\n    @Prop({type: String})\n    readonly section!: string;\n\n    @Prop({type: String})\n    readonly nestedSection!: string;\n\n    @Prop({type: String})\n    readonly nestedId!: string;\n\n    @Prop({type: Function})\n    readonly closeNestedAction!: any;\n\n    editor: EditorView | null = null;\n    showNested = false;\n    nestedSettings = null as any;\n    internalContentUpdate = false;\n    stateDebounce: number | null = null\n\n    active: TextEditorActiveElements = {};\n\n    // ===================\n    // Computed properties\n    // ===================\n\n    public get schema() {\n        return this.$store.state.sections[this.$props.section].schema;\n    }\n\n    public get editorSchema() {\n        return new Schema({\n            nodes: generateSchemaNodes(this.schema),\n            marks: generateSchemaMarks(this.schema),\n        });\n    }\n\n    public get editorPlugins() {\n        return [\n            history(),\n            keymap({\n                'Mod-z': undo,\n                'Mod-y': redo\n            }),\n            keymap(baseKeymap)\n        ];\n    }\n\n    public get content() {\n        return this.$store.state.content[this.$props.section];\n    }\n\n    public get doc() {\n        if (this.content) {\n            if (this.$props.nestedSection && this.$props.nestedId) {\n                if (this.content.nested && this.content.nested[this.$props.nestedSection] && this.content.nested[this.$props.nestedSection][this.$props.nestedId]) {\n                    return this.content.nested[this.$props.nestedSection][this.$props.nestedId].content[0];\n                }\n            } else {\n                return this.content.doc;\n            }\n        }\n        return null;\n    }\n\n    public get ui() {\n        if (this.$props.nestedSection && this.$store.state.sections[this.$props.section].ui[this.$props.nestedSection]) {\n            return this.$store.state.sections[this.$props.section].ui[this.$props.nestedSection];\n        } else {\n            return this.$store.state.sections[this.$props.section].ui.doc;\n        }\n    }\n\n    public get sidebar() {\n        return this.ui.map((blockSchema: TextEditorSidebarBlockConfig) => {\n            return {\n                label: blockSchema.label,\n                active: blockSchema.condition ? this.active[blockSchema.condition.activeType] : true,\n                entities: blockSchema.entities ? blockSchema.entities.map((entitySchema) => {\n                    return {\n                        type: entitySchema.type,\n                        entities: entitySchema.entities.map((elementSchema, idx: number) => {\n                            const entity = {\n                                type: elementSchema.type,\n                                label: elementSchema.label,\n                                nodeType: elementSchema.nodeType || elementSchema.markType,\n                                attr: elementSchema.attr,\n                                value: elementSchema.value ? elementSchema.value : '',\n                                values: [] as {[x: string]: string | null}[],\n                                checked: 'false',\n                                tabindex: idx === 0 ? 0 : -1,\n                                ariaLabel: elementSchema.ariaLabel,\n                                targetNodeType: elementSchema.targetNodeType,\n                            };\n                            if (elementSchema.type === 'setNodeType') {\n                                entity.checked = elementSchema.nodeType && this.active[elementSchema.nodeType] ? 'true': 'false';\n                            } else if (elementSchema.type === 'setNodeAttrValue') {\n                                entity.checked = elementSchema.nodeType && elementSchema.attr && this.active[elementSchema.nodeType] && this.active[elementSchema.nodeType][elementSchema.attr] === elementSchema.value ? 'true' : 'false';\n                            } else if (elementSchema.type === 'selectNodeAttr') {\n                                entity.values = elementSchema.values.map((entry) => {\n                                    return {\n                                        value: entry.value,\n                                        label: entry.label,\n                                        checked: elementSchema.nodeType && elementSchema.attr && this.active[elementSchema.nodeType] && this.active[elementSchema.nodeType][elementSchema.attr] === entry.value ? 'selected' : null,\n                                    };\n                                });\n                            } else if (elementSchema.type === 'toggleMark') {\n                                entity.checked = elementSchema.markType && this.active[elementSchema.markType] ? 'true' : 'false';\n                            } else if (elementSchema.type === 'selectMarkAttr') {\n                                entity.values = elementSchema.values.map((entry) => {\n                                    return {\n                                        value: entry.value,\n                                        label: entry.label,\n                                        checked: elementSchema.markType && elementSchema.attr && this.active[elementSchema.markType] && this.active[elementSchema.markType][elementSchema.attr] === entry.value ? 'selected' : null,\n                                    };\n                                });\n                            // } else if (elementSchema.type === 'editNestedDoc') {\n                            } else if (elementSchema.type === 'linkNestedDoc') {\n                                if (elementSchema.targetNodeType && this.nestedDocIds[elementSchema.targetNodeType]) {\n                                    entity.values = this.nestedDocIds[elementSchema.targetNodeType].map((entry) => {\n                                        return {\n                                            value: entry.value,\n                                            label: entry.label,\n                                            checked: elementSchema.nodeType && elementSchema.attr && this.active[elementSchema.nodeType] && this.active[elementSchema.nodeType][elementSchema.attr] === entry.value ? 'selected' : null,\n                                        };\n                                    });\n                                }\n                            } else if (elementSchema.type === 'setNodeAttrString') {\n                                entity.value = elementSchema.nodeType && this.active[elementSchema.nodeType] && this.active[elementSchema.nodeType][elementSchema.attr] ? this.active[elementSchema.nodeType][elementSchema.attr]: '';\n                            }\n                            return entity;\n                        }),\n                    }\n                }) : [],\n            }\n        });\n    }\n\n    /**\n     * Computed property to get the available nested doc ids.\n     */\n    public get nestedDocIds() {\n        let nestedIds = {} as { [x: string]: TextEditorMenuItemValuesValue[] };\n        Object.entries(this.$store.state.content[this.$props.section].nested).forEach(([nestedKey, docObj]: any) => {\n            nestedIds[nestedKey] = Object.keys(docObj).map((docKey: string) => {\n                return {\n                    label: docKey,\n                    value: docKey,\n                };\n            });\n            nestedIds[nestedKey].splice(0, 0, {label: 'New', value: ''});\n        });\n        return nestedIds;\n    }\n\n    public mounted() {\n        // Initialise the editor\n        const component = this;\n        this.editor = new EditorView(this.$el.querySelector('.editor') as Node, {\n            state: EditorState.create({\n                schema: this.editorSchema,\n                doc: this.doc ? this.editorSchema.nodeFromJSON(this.doc) : null,\n                plugins: this.editorPlugins,\n            }),\n            dispatchTransaction(transaction) {\n                if (component.editor) {\n                    let newState = component.editor.state.apply(transaction);\n                    component.stateChanged(newState, transaction);\n                    component.internalContentUpdate = true;\n                    if (component.$props.nestedSection && component.$props.nestedId) {\n                        component.$store.commit('setTextDoc', {\n                            path: component.$props.section + '.nestedId.' + component.$props.nestedSection + '.' + component.$props.nestedId,\n                            doc: newState.doc.toJSON(),\n                        });\n                    } else {\n                        component.$store.commit('setTextDoc', {\n                            path: component.$props.section + '.doc',\n                            doc: newState.doc.toJSON(),\n                        });\n                    }\n                    component.editor.updateState(newState);\n                }\n            },\n        });\n    }\n\n    public beforeDestroy() {\n        if (this.editor) {\n            this.editor.destroy();\n        }\n    }\n\n    @Watch('doc')\n    public updateContent(newValue: any) {\n        if (!this.internalContentUpdate && this.editor) {\n            this.editor.updateState(EditorState.create({\n                schema: this.editorSchema,\n                doc: this.editorSchema.nodeFromJSON(this.doc),\n                plugins: this.editorPlugins,\n            }));\n        }\n        this.internalContentUpdate = false;\n    }\n\n    // ==============\n    // Event handlers\n    // ==============\n\n    public stateChanged(state: EditorState, transaction: Transaction) {\n        if (this.stateDebounce !== null) {\n            clearTimeout(this.stateDebounce);\n        }\n        this.stateDebounce = setTimeout(() => {\n            const { from, to } = state.selection;\n            const active: TextEditorActiveElements = {};\n            state.doc.nodesBetween(from, to, (node) => {\n                active[node.type.name] = node.attrs;\n                if (node.marks) {\n                    node.marks.forEach((mark) => {\n                        if (mark.attrs) {\n                            active[mark.type.name] = mark.attrs;\n                        } else {\n                            active[mark.type.name] = {};\n                        }\n                    });\n                }\n            });\n            this.active = active;\n        }, transaction.steps.length > 0 ? 500 : 50);\n    }\n\n    public menuAction(menuItem: TextEditorMenuItem, event: Event) {\n        if (this.editor) {\n            if (menuItem.type === 'setNodeType' && menuItem.nodeType) {\n                if (this.editorSchema.nodes[menuItem.nodeType].isInline) {\n                    const slice = this.editor.state.selection.content();\n                    if (this.active[menuItem.nodeType]) {\n                        const nodeCallback = (node: ProsemirrorNode) => {\n                            if (node.type.isBlock) {\n                                return this.editorSchema.nodes[node.type.name].create({}, this.walkFragment(node.content, nodeCallback));\n                            } else if (node.type.isInline && node.type.name === menuItem.nodeType) {\n                                return this.editorSchema.text(node.textContent);\n                            } else {\n                                return node;\n                            }\n                        }\n                        const fragment = this.walkFragment(slice.content, nodeCallback);\n                        this.editor.dispatch(this.editor.state.tr.replaceSelection(new Slice(fragment, slice.openStart, slice.openEnd)));\n                    } else {\n                        const nodeCallback = (node: ProsemirrorNode) => {\n                            if (node.type.isBlock) {\n                                return this.editorSchema.nodes[node.type.name].create(node.attrs, this.walkFragment(node.content, nodeCallback));\n                            } else if (node.type.isText && menuItem.nodeType) {\n                                return this.editorSchema.nodes[menuItem.nodeType].create({}, node);\n                            } else if (node.type.isInline && menuItem.nodeType) {\n                                return this.editorSchema.nodes[menuItem.nodeType].create(node.attrs, node.content);\n                            } else {\n                                return node;\n                            }\n                        }\n                        const fragment = this.walkFragment(slice.content, nodeCallback);\n                        this.editor.dispatch(this.editor.state.tr.replaceSelection(new Slice(fragment, slice.openStart, slice.openEnd)));\n                    }\n                } else {\n                    if (this.isWrappingType(menuItem.nodeType)) {\n                        let contentNodeType = '';\n                        for (let idx = 0; idx < this.schema.length; idx++) {\n                            if (this.schema[idx].name === menuItem.nodeType && this.schema[idx].type === 'wrapping') {\n                                contentNodeType = this.schema[idx].content;\n                            }\n                        }\n                        wrapNode(this.editorSchema.nodes[menuItem.nodeType], this.editorSchema.nodes[contentNodeType])(this.editor.state, this.editor.dispatch);\n                    } else {\n                        if (isWrappedNode(this.editor.state, this.schema, this.editorSchema)) {\n                            unwrapNode(this.editorSchema.nodes[menuItem.nodeType])(this.editor.state, this.editor.dispatch)\n                        } else {\n                            setBlockType(this.editorSchema.nodes[menuItem.nodeType], {})(this.editor.state, this.editor.dispatch);\n                        }\n                    }\n                }\n            } else if ((menuItem.type === 'setNodeAttrValue' || menuItem.type === 'selectNodeAttr' || menuItem.type === 'setNodeAttrString') && menuItem.nodeType) {\n                let attrs = {} as { [x: string]: string };\n                if (this.active[menuItem.nodeType]) {\n                    attrs = deepclone(this.active[menuItem.nodeType]);\n                }\n                if (menuItem.attr) {\n                    if (event && event.target) {\n                        attrs[menuItem.attr] = (event.target as HTMLInputElement).value;\n                    } else if (menuItem.value) {\n                        attrs[menuItem.attr] = menuItem.value;\n                    }\n                }\n                if (this.editorSchema.nodes[menuItem.nodeType].isInline) {\n                    updateInlineNode(this.editorSchema.nodes[menuItem.nodeType], attrs)(this.editor.state, this.editor.dispatch);\n                } else {\n                    setBlockType(this.editorSchema.nodes[menuItem.nodeType], attrs)(this.editor.state, this.editor.dispatch);\n                }\n            } else if (menuItem.type === 'toggleMark' && menuItem.nodeType) {\n                toggleMark(this.editorSchema.marks[menuItem.nodeType])(this.editor.state, this.editor.dispatch);\n            } else if (menuItem.type === 'selectMarkAttr' && menuItem.nodeType) {\n                let attrs = {} as { [x: string]: string };\n                if (this.active[menuItem.nodeType]) {\n                    attrs = deepclone(this.active[menuItem.nodeType]);\n                }\n                if (menuItem.attr) {\n                    if (event && event.target) {\n                        attrs[menuItem.attr] = (event.target as HTMLInputElement).value;\n                    } else if (menuItem.value) {\n                        attrs[menuItem.attr] = menuItem.value;\n                    }\n                }\n                if (attrs[menuItem.attr] === '') {\n                    removeMark(this.editorSchema.marks[menuItem.nodeType])(this.editor.state, this.editor.dispatch);\n                } else {\n                    updateMark(this.editorSchema.marks[menuItem.nodeType], attrs)(this.editor.state, this.editor.dispatch);\n                }\n            } else if (menuItem.type === 'linkNestedDoc' && menuItem.nodeType) {\n                let attrs = {} as { [x: string]: string };\n                if (this.active[menuItem.nodeType]) {\n                    attrs = deepclone(this.active[menuItem.nodeType]);\n                }\n                if (menuItem.attr) {\n                    if (event && event.target) {\n                        attrs[menuItem.attr] = (event.target as HTMLInputElement).value;\n                    } else if (menuItem.value) {\n                        attrs[menuItem.attr] = menuItem.value;\n                    }\n                }\n                updateInlineNode(this.editorSchema.nodes[menuItem.nodeType], attrs)(this.editor.state, this.editor.dispatch);\n            } else if (menuItem.type === 'editNestedDoc') {\n                if (menuItem.nodeType && menuItem.attr && menuItem.targetNodeType && this.active[menuItem.nodeType]) {\n                    let nestedId = this.active[menuItem.nodeType][menuItem.attr];\n                    if (!this.active[menuItem.nodeType][menuItem.attr]) {\n                        const nestedDocs = this.$store.state.content[this.$props.section].nested[menuItem.targetNodeType];\n                        nestedId = menuItem.targetNodeType + '-1';\n                        let idx = 1;\n                        while (nestedDocs && nestedDocs[nestedId]) {\n                            idx = idx + 1;\n                            nestedId = menuItem.targetNodeType + '-' + idx;\n                        }\n                        let attrs = {} as { [x: string]: string };\n                        if (this.active[menuItem.nodeType]) {\n                            attrs = deepclone(this.active[menuItem.nodeType]);\n                        }\n                        if (menuItem.attr) {\n                            attrs[menuItem.attr] = nestedId;\n                        }\n                        updateInlineNode(this.editorSchema.nodes[menuItem.nodeType], attrs)(this.editor.state, this.editor.dispatch);\n                        this.$store.commit('addNestedDoc', { path: this.$props.section + '.nested.' + menuItem.targetNodeType + '.' + nestedId, doc: {type: 'doc', content: [{type: 'paragraph', content: []}]}});\n                    }\n                    this.showNested = true;\n                    this.nestedSettings = {\n                        section: menuItem.targetNodeType,\n                        id: nestedId,\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Close the nested editor.\n     */\n    public closeNestedEditor() {\n        this.showNested = false;\n        this.nestedSettings = null;\n    }\n\n    // ===============\n    // Private Helpers\n    // ===============\n\n    private walkFragment(fragment: Fragment, callback: (x: ProsemirrorNode) => ProsemirrorNode) {\n        for (let idx = 0; idx < fragment.childCount; idx++) {\n            fragment = fragment.replaceChild(idx, callback(fragment.child(idx)));\n        }\n        return fragment;\n    }\n\n    private isWrappingType(typeName: string) {\n        for (let idx = 0; idx < this.schema.length; idx++) {\n            if (this.schema[idx].name === typeName && this.schema[idx].type === 'wrapping') {\n                return true;\n            }\n        }\n        return false;\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextEditor.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextEditor.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TextEditor.vue?vue&type=template&id=d40519aa&\"\nimport script from \"./TextEditor.vue?vue&type=script&lang=ts&\"\nexport * from \"./TextEditor.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default class TEISerialiser {\n    nested: any;\n\n    public serialise(data: any, sections: any) {\n        let root = {\n            node: 'tei:TEI',\n            attrs: {\n                'xmlns:tei': ['http://www.tei-c.org/ns/1.0']\n            },\n            children: []\n        }\n        Object.entries(sections).forEach(([key, section]: any) => {\n            if (section.type === 'MetadataEditor') {\n                this.mergeTrees(root, this.serialiseHeader(data[key], section));\n            }\n        });\n        Object.entries(sections).forEach(([key, section]: any) => {\n            if (section.type === 'TextEditor') {\n                this.mergeTrees(root, this.serialiseSingleText(data[key], section));\n            }\n        });\n        let lines = this.toString(root, '');\n        lines.splice(0, 0, '<?xml version=\"1.0\" encoding=\"UTF-8\"?>');\n        lines.push('');\n        return lines.join('\\n');\n    }\n\n    private mergeTrees(base: any, merge: any) {\n        // Merge one tree into another. If either of the two trees tries to merge at a level where sibling nodes have the\n        // same tags, this will break\n        if (base && merge) {\n            for (let idx = 0; idx < merge.children.length; idx++) {\n                let found = false;\n                for (let idx2 = 0; idx2 < base.children.length; idx2++) {\n                    if (base.children[idx2].node === merge.children[idx].node && this.objectsMatch(base.children[idx2].attrs, merge.children[idx].attrs)) {\n                        this.mergeTrees(base.children[idx2], merge.children[idx]);\n                        found = true;\n                    }\n                }\n                if (!found) {\n                    base.children.push(merge.children[idx]);\n                }\n            }\n        }\n    }\n\n    private objectsMatch(a: any, b: any) {\n        if (a && b) {\n            if (typeof a !== typeof b) {\n                return false;\n            } else if (typeof a === 'string' || typeof a === 'number' || typeof a === 'boolean') {\n                return a === b;\n            }\n            let keysA = Object.keys(a);\n            let keysB = Object.keys(b);\n            keysA.forEach((key) => {\n                if (keysB.indexOf(key) < 0) {\n                    return false;\n                }\n                if (!this.objectsMatch(a[key], b[key])) {\n                    return false;\n                }\n                keysB.splice(keysB.indexOf(key), 1);\n            });\n            if (keysB.length > 0) {\n                return false;\n            }\n            return true;\n        } else if(!a && !b) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    private serialiseSingleText(data: any, section: any) {\n        if (data) {\n            let rootPath = section.serialiser.tag.split('/');\n            this.nested = {} as any;\n            let text = {\n                node: rootPath[rootPath.length - 1],\n                children: data.doc.content.map((item: any) => {\n                    return this.serialiseTextNode(item, section.schema);\n                }),\n                attrs: {}\n            } as any;\n            if (section.serialiser.attrs) {\n                Object.entries(section.serialiser.attrs).forEach(([key, value]) => {\n                    if (text.attrs[key]) {\n                        text.attrs[key].push(value);\n                    } else {\n                        text.attrs[key] = [value];\n                    }\n                });\n            }\n            Object.entries(this.nested).forEach(([key, ids]: any) => {\n                new Set(ids).forEach((id: any) => {\n                    if (data.nested[key] && data.nested[key][id]) {\n                        text.children.push(this.serialiseTextNode(data.nested[key][id], section.schema));\n                    }\n                })\n            });\n\n            for (let idx = rootPath.length - 2; idx >= 0; idx--) {\n                text = {\n                    node: rootPath[idx],\n                    children: [\n                        text,\n                    ]\n                };\n            }\n\n            return {\n                node: 'tei:TEI',\n                children: [\n                    text\n                ]\n            }\n        } else {\n            return null;\n        }\n    }\n\n    private serialiseTextNode(node: any, schema: any) {\n        let nodeSchema = schema.filter((part: any) => { return part.name === node.type && part.serialiser });\n        if (nodeSchema.length === 1) {\n            nodeSchema = nodeSchema[0];\n            // Basic structure\n            let obj = {\n                node: nodeSchema.serialiser.tag,\n                attrs: {},\n                children: [],\n                text: null\n            } as any;\n            // Optional static attributes defined by the node itself\n            if (nodeSchema.serialiser.attrs) {\n                Object.entries(nodeSchema.serialiser.attrs).forEach((entry: any) => {\n                    obj.attrs[entry[0]] = [entry[1]];\n                });\n            }\n            // Attributes are serialised as a dict of key => list pairs to simplify handling multi-value attributes\n            if (node.attrs) {\n                Object.entries(node.attrs).forEach((entry: any) => {\n                    let serialiser = nodeSchema.attrs[entry[0]].serialiser;\n                    if (serialiser) {\n                        let value = undefined;\n                        // Values can either be serialised directly, through string replacement in the value key, or\n                        // through value lookup in the values key.\n                        if (serialiser.values) {\n                            if (serialiser.values[entry[1]]) {\n                                value = serialiser.values[entry[1]];\n                            }\n                        } else if (serialiser.value) {\n                            value = serialiser.value.replace('{value}', entry[1]);\n                        } else {\n                            value = entry[1];\n                        }\n                        if (value !== undefined) {\n                            if (serialiser.attr === 'text()') {\n                                obj.text = value;\n                            } else {\n                                if (obj.attrs[serialiser.attr]) {\n                                    obj.attrs[serialiser.attr].push(value);\n                                } else {\n                                    obj.attrs[serialiser.attr] = [value];\n                                }\n                            }\n                        }\n                    }\n                });\n            }\n            if (nodeSchema.type === 'inline') {\n                if (node.content) {\n                    // Inline nodes with content are serialised like any other block node, if they have more than one\n                    // content element. Otherwise the text is fetched from the single child element\n                    if (node.content.length > 1 || (node.content[0].marks && node.content[0].marks.length > 0)) {\n                        node.content.forEach((child: any) => {\n                            obj.children.push(this.serialiseTextNode(child, schema));\n                        });\n                    } else {\n                        let temp = this.serialiseTextNode(node.content[0], schema);\n                        if (nodeSchema.serialiser.text) {\n                            // By setting the text.attr value in the serialiser, the text can be serialised into an attribute\n                            if (obj.attrs[nodeSchema.serialiser.text.attr]) {\n                                obj.attrs[nodeSchema.serialiser.text.attr].push(temp.text);\n                            } else {\n                                obj.attrs[nodeSchema.serialiser.text.attr] = [temp.text];\n                            }\n                        } else {\n                            obj.text = temp.text;\n                        }\n                    }\n                } else if (node.text) {\n                    // As above allow serialisation of text into an attribute\n                    if (nodeSchema.serialiser.text) {\n                        if (obj.attrs[nodeSchema.serialiser.text.attr]) {\n                            obj.attrs[nodeSchema.serialiser.text.attr].push(node.text);\n                        } else {\n                            obj.attrs[nodeSchema.serialiser.text.attr] = [node.text];\n                        }\n                    } else {\n                        obj.text = node.text;\n                    }\n                }\n                if (node.marks) {\n                    // First map all marks to temporary objects\n                    let markObjs = node.marks.map((mark: any) => {\n                        let markSchema = schema.filter((part: any) => { return part.name === mark.type && part.serialiser });\n                        if (markSchema.length === 1) {\n                            markSchema = markSchema[0];\n                            let markObj = {\n                                node: obj.node,\n                                attrs: {}\n                            } as any;\n                            let serialiser = markSchema.serialiser;\n                            if (serialiser.tag) {\n                                markObj.node = serialiser.tag;\n                            }\n                            if (serialiser.attrs) {\n                                // Static attribute values can be serialised into the node for marks\n                                Object.entries(serialiser.attrs).forEach((entry: any) => {\n                                    if (entry[1].value) {\n                                        if (markObj.attrs[entry[0]]) {\n                                            markObj.attrs[entry[0]].push(entry[1].value);\n                                        } else {\n                                            markObj.attrs[entry[0]] = [entry[1].value];\n                                        }\n                                    }\n                                });\n                            }\n                            if (mark.attrs) {\n                                Object.entries(mark.attrs).forEach((entry: any) => {\n                                    // Marks with attributes can have those attributes serialised either via a value replacement\n                                    // or through value lookup in the values dict.\n                                    let value = undefined;\n                                    if (markSchema.attrs[entry[0]].serialiser.value) {\n                                        value = markSchema.attrs[entry[0]].serialiser.value.replace('{value}', entry[1]);\n                                    } else if (markSchema.attrs[entry[0]].serialiser.values) {\n                                        if (markSchema.attrs[entry[0]].serialiser.values[entry[1]]) {\n                                            value = markSchema.attrs[entry[0]].serialiser.values[entry[1]];\n                                        }\n                                    }\n                                    if (value !== undefined) {\n                                        if (markObj.attrs[markSchema.attrs[entry[0]].serialiser.attr]) {\n                                            markObj.attrs[markSchema.attrs[entry[0]].serialiser.attr].push(value);\n                                        } else {\n                                            markObj.attrs[markSchema.attrs[entry[0]].serialiser.attr] = [value];\n                                        }\n                                    }\n                                });\n                            }\n                            return markObj;\n                        } else {\n                            return null;\n                        }\n                    }).filter((markObj: any) => { return markObj; });\n                    if ((new Set(markObjs.map((markObj: any) => { return markObj.node; }))).size > 1) {\n                        // If there are multiple nodes in the marks, then the output needs to be nested\n                        markObjs.sort((a: any, b: any) => {\n                            if (a.node < b.node) {\n                                return -1;\n                            } else if (a.node > b.node) {\n                                return 1;\n                            } else if (a.node === b.node) {\n                                return 0;\n                            }\n                        });\n                        let target = obj;\n                        target.node = null;\n                        // Build the nested structure\n                        markObjs.forEach((markObj: any) => {\n                            if (target.node === null || target.node === markObj.node) {\n                                target.node = markObj.node;\n                                Object.entries(markObj.attrs).forEach((entry) => {\n                                    if (target.attrs[entry[0]]) {\n                                        target.attrs[entry[0]] = target.attrs[entry[0]].concat(entry[1]);\n                                    } else {\n                                        target.attrs[entry[0]] = entry[1];\n                                    }\n                                });\n                            } else {\n                                let tmpObj = {\n                                    node: markObj.node,\n                                    attrs: markObj.attrs,\n                                    children: [],\n                                    text: target.text\n                                };\n                                target.text = null;\n                                target.children.push(tmpObj);\n                                target = tmpObj;\n                            }\n                        });\n                    } else {\n                        // If there is only one node in the marks, then the output can be flattened\n                        markObjs.forEach((markObj: any) => {\n                            if (markObj) {\n                                if (markObj.node) {\n                                    obj.node = markObj.node;\n                                }\n                                if (markObj.attrs) {\n                                    Object.entries(markObj.attrs).forEach((entry: any) => {\n                                        if (obj.attrs[entry[0]]) {\n                                            obj.attrs[entry[0]] = obj.attrs[entry[0]].concat(entry[1]);\n                                        } else {\n                                            obj.attrs[entry[0]] = entry[1];\n                                        }\n                                    });\n                                }\n                            }\n                        });\n                    }\n                }\n            } else if (node.content) {\n                // Block nodes simply get their content\n                node.content.forEach((child: any) => {\n                    if (child.type === 'doc') {\n                        if (child.content) {\n                            child.content.forEach((subChild: any) => {\n                                obj.children.push(this.serialiseTextNode(subChild, schema));\n                            });\n                        }\n                    } else {\n                        obj.children.push(this.serialiseTextNode(child, schema));\n                    }\n                });\n            }\n            // Check for links to nested objects\n            if (nodeSchema.reference) {\n                if (!this.nested[nodeSchema.reference.type]) {\n                    this.nested[nodeSchema.reference.type] = [];\n                }\n                this.nested[nodeSchema.reference.type].push(node.attrs[nodeSchema.reference.attr]);\n            }\n            if (obj.children.length > 0 || obj.text || Object.keys(obj.attrs).length > 0) {\n                return obj;\n            } else {\n                return null;\n            }\n        } else {\n            return null;\n        }\n    }\n\n    private serialiseHeader(data: any, section: any) {\n        return {\n            node: 'tei:TEI',\n            children: [\n                {\n                    node: 'tei:teiHeader',\n                    children: section.schema.map((config: any) => {return this.serialiseMetadataNode(data[config.tag.substring(4)], config)})\n                }\n            ]\n        }\n    }\n\n    private serialiseMetadataNode(data: any, config: any) {\n        if (config.multiple) {\n            let items = data.map((item: any) => {\n                let result = {\n                    node: config.tag\n                } as any;\n                if (item._text) {\n                    result.text = item._text;\n                }\n                if (item._attrs) {\n                    result.attrs = {};\n                    Object.entries(item._attrs).forEach((entry: any) => {\n                        result.attrs[entry[0]] = [entry[1]];\n                    });\n                }\n                if (config.children) {\n                    result.children = [];\n                    for (let idx = 0; idx < config.children.length; idx++) {\n                        if (item[config.children[idx].tag.substring(4)]) {\n                            let temp = this.serialiseMetadataNode(item[config.children[idx].tag.substring(4)], config.children[idx]);\n                            if (Array.isArray(temp)) {\n                                result.children = result.children.concat(temp);\n                            } else {\n                                result.children.push(temp);\n                            }\n                        }\n                    }\n                }\n                return result;\n            });\n            return items;\n        } else {\n            let result = {\n                node: config.tag\n            } as any;\n            if (data) {\n                if (data._text) {\n                    result.text = data._text;\n                }\n                if (data._attrs) {\n                    result.attrs = {};\n                    Object.entries(data._attrs).forEach((entry: any) => {\n                        result.attrs[entry[0]] = [entry[1]];\n                    });\n                }\n                if (config.children) {\n                    result.children = [];\n                    for (let idx = 0; idx < config.children.length; idx++) {\n                        if (data[config.children[idx].tag.substring(4)]) {\n                            let temp = this.serialiseMetadataNode(data[config.children[idx].tag.substring(4)], config.children[idx]);\n                            if (Array.isArray(temp)) {\n                                result.children = result.children.concat(temp);\n                            } else {\n                                result.children.push(temp);\n                            }\n                        }\n                    }\n                }\n            }\n            return result;\n        }\n    }\n\n    private toString(node: any, indentation: string) {\n        function xmlSafe(txt: string) {\n            return txt.replace('&', '&amp;').replace('<', '&lt;').replace('>', '&gt;');\n        }\n\n        // Render a node into an XML string representation as a list of lines\n        let lines = [] as any[];\n        if (node) {\n            let buffer = [indentation, '<', node.node];\n            if (node.attrs) {\n                Object.entries(node.attrs).forEach((entry: any) => {\n                    if (entry[1].length > 0) {\n                        entry[1].sort();\n                        buffer.push(' ' + entry[0] + '=\"' + xmlSafe(entry[1].join(' ')) + '\"');\n                    }\n                });\n            }\n            if (node.children && node.children.length > 0) {\n                buffer.push('>');\n                lines.push(buffer.join(''));\n                node.children.forEach((child: any) => {\n                    lines = lines.concat(this.toString(child, indentation + '  '));\n                });\n                lines.push(indentation + '</' + node.node + '>');\n            } else {\n                if (node.text) {\n                    buffer.push('>');\n                    buffer.push(xmlSafe(node.text));\n                    buffer.push('</' + node.node + '>');\n                } else {\n                    buffer.push('/>');\n                }\n                lines.push(buffer.join(''));\n            }\n        }\n        return lines;\n    }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Watch } from 'vue-property-decorator';\nimport AriaMenubar from './AriaMenubar.vue';\nimport AriaMenu from './AriaMenu.vue';\nimport MetadataEditor from './MetadataEditor.vue';\nimport TextEditor from './TextEditor.vue';\nimport TEISeraliser from '@/util/TEISerialiser';\nimport get from '@/util/get';\n\n@Component({\n    components: {\n        AriaMenubar,\n        AriaMenu,\n        MetadataEditor,\n        TextEditor,\n    },\n})\nexport default class TeiEditor extends Vue {\n    currentSection: string | null = null;\n\n    public get sections() {\n        return this.$store.state.sections;\n    }\n\n    public get hasSaveCallback() {\n        return this.$store.state.callbacks.save ? true : false;\n    }\n\n    public get hasLoadCallback() {\n        return this.$store.state.callbacks.load ? true : false;\n    }\n\n    public setCurrentSection(section: string) {\n        this.currentSection = section;\n    }\n\n    public getContentForSection(sectionName: string) {\n        return get(this.$store.state.content, sectionName);\n    }\n\n    public setContentForSection(section: string, doc: any) {\n        this.$store.commit('setTextDoc', { path: section, doc: doc});\n    }\n\n    public mounted() {\n        let sections = Object.keys(this.sections);\n        if (sections.length > 0) {\n            this.currentSection = sections[0];\n        }\n    }\n\n    public save() {\n        if (this.hasSaveCallback) {\n            let serialiser = new TEISeraliser();\n            this.$store.state.callbacks.save(serialiser.serialise(this.$store.state.content, this.$store.state.sections));\n        }\n    }\n\n    public load() {\n        if (this.hasLoadCallback) {\n            this.$store.state.callbacks.load((data: string) => {\n                this.$store.dispatch('load', data);\n            });\n        }\n    }\n\n    @Watch('sections')\n    public updateSections() {\n        let sections = Object.keys(this.sections);\n        if (sections.length > 0) {\n            this.currentSection = sections[0];\n        }\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TeiEditor.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TeiEditor.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TeiEditor.vue?vue&type=template&id=76fb38c7&\"\nimport script from \"./TeiEditor.vue?vue&type=script&lang=ts&\"\nexport * from \"./TeiEditor.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./TeiEditor.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\nimport TeiEditor from \"./components/TeiEditor.vue\";\n\n@Component({\n    components: {\n        TeiEditor\n    }\n})\nexport default class App extends Vue {\n    public mounted() {\n        let configElement = document.getElementById('TEIEditorConfig');\n        if (configElement) {\n            let config = JSON.parse(configElement.innerHTML);\n            if (config) {\n                this.$store.commit('init', config);\n            }\n        }\n        if (this.$store.state.callbacks && this.$store.state.callbacks.autoLoad) {\n            this.$store.state.callbacks.autoLoad((sourceData: string) => {\n                this.$store.dispatch('load', sourceData);\n            });\n        }\n    }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=ecb5936c&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","function nsResolver(prefix: string | null) {\n    if (prefix === 'tei') {\n        return 'http://www.tei-c.org/ns/1.0';\n    } else if (prefix === 'xml') {\n        return 'http://www.w3.org/XML/1998/namespace';\n    } else {\n        return 'http://www.tei-c.org/ns/1.0';\n    }\n}\n\nexport default class XPathEvaluator {\n    private dom: XMLDocument;\n\n    constructor (dom: XMLDocument) {\n        this.dom = dom;\n    }\n\n    evaluate(node: Node, xpath: string, result_type: number) {\n        return this.dom.evaluate(xpath, node, nsResolver, result_type, null);\n    }\n\n    firstNode(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.FIRST_ORDERED_NODE_TYPE).singleNodeValue;\n    }\n\n    nodeIterator(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.ORDERED_NODE_ITERATOR_TYPE);\n    }\n\n    stringValue(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.STRING_TYPE).stringValue;\n    }\n\n    booleanValue(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.BOOLEAN_TYPE).booleanValue;\n    }\n\n    numberValue(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.NUMBER_TYPE).numberValue;\n    }\n}\n","import XPathEvaluator from './XPathEvaluator';\nimport get from './get';\n\nexport default class TEIMetadataParser {\n    private dom: XMLDocument;\n    private xpath: XPathEvaluator;\n    private config: any;\n    private data: any;\n\n    constructor(dom: XMLDocument, config: any) {\n        this.dom = dom;\n        this.xpath = new XPathEvaluator(this.dom);\n        this.config = config;\n    }\n\n    public get() {\n        if (!this.data) {\n            let header = <Element>this.xpath.firstNode(this.dom.documentElement, '/tei:TEI/tei:teiHeader');\n            this.data = {};\n            for (let idx = 0; idx < this.config.schema.length; idx++) {\n                let temp = this.parseHeaderNode(header, this.config.schema[idx]);\n                if (temp) {\n                    this.data[this.config.schema[idx].tag.substring(4)] = temp;\n                }\n            }\n        }\n        return this.data;\n    }\n\n    private parseHeaderNode(node: Element, schema: any) {\n        let elements = this.xpath.nodeIterator(node, schema.tag);\n        let result = <any>[];\n        let element = <Element>elements.iterateNext();\n        while (element) {\n            let obj = <any>{\n                _attrs: {},\n                _text: element.children.length === 0 ? this.xpath.stringValue(element, 'text()') : null\n            };\n            for(let idx = 0; idx < element.attributes.length; idx++) {\n                obj._attrs[element.attributes[idx].name] = element.attributes[idx].value;\n            }\n            if (schema.children) {\n                for (let idx = 0; idx < schema.children.length; idx++) {\n                    let temp = this.parseHeaderNode(element, schema.children[idx]);\n                    if (temp) {\n                        obj[schema.children[idx].tag.substring(schema.children[idx].tag.indexOf(':') + 1)] = temp;\n                    }\n                }\n            }\n            result.push(obj);\n            element = <Element>elements.iterateNext();\n        }\n        if (result.length === 0) {\n            return null;\n        } else {\n            if (schema.multiple) {\n                return result;\n            } else {\n                return result[0];\n            }\n        }\n    }\n}\n","import XPathEvaluator from './XPathEvaluator';\nimport get from './get';\n\nexport default class TEIParser {\n    private dom: XMLDocument;\n    private xpath: XPathEvaluator;\n    private config: any;\n    private doc: any;\n    private nestedDocs: any;\n\n    constructor(dom: XMLDocument, config: any) {\n        this.dom = dom;\n        this.xpath = new XPathEvaluator(this.dom);\n        this.config = config;\n    }\n\n    public get() {\n        if (!this.doc) {\n            this.doc = {\n                type: 'doc',\n                content: [],\n            };\n            this.nestedDocs = {};\n            if (this.config.parser && this.config.parser.selector) {\n                let node = <Element>this.xpath.firstNode(this.dom.documentElement, this.config.parser.selector);\n                if (node) {\n                    for(let idx = 0; idx < node.children.length; idx++) {\n                        let tmp = this.parseContentNode(node.children[idx], this.config);\n                        if (tmp && !tmp.nestedDoc) {\n                            this.doc.content.push(tmp);\n                        } else if (tmp && tmp.nestedDoc) {\n                            this.addNestedDoc(tmp);\n                        }\n                    }\n                }\n            }\n        }\n        return [this.doc, this.nestedDocs];\n    }\n\n    private parseContentAttributes(node: Element, attrs: any) {\n        // Parse attributes for nodes or marks. Attributes can have a type which is boolean, number, static, or string (default).\n        let result = <any>{};\n        Object.entries(attrs).forEach(([key, schema]: any) => {\n            let parsers = <any>[];\n            if (schema.parser) {\n                parsers.push(schema.parser);\n            } else if (schema.parsers) {\n                parsers = schema.parsers;\n            }\n            for (let idx = 0; idx < parsers.length; idx++) {\n                let parser = parsers[idx];\n                if (parser.type === 'boolean') {\n                    result[key] = this.xpath.booleanValue(node, parser.selector);\n                } else if (parser.type === 'number') {\n                    try {\n                        result[key] = this.xpath.numberValue(node, parser.selector);\n                    } catch(e) {\n                        // eslint-disable-next-line\n                        console.log(e);\n                    }\n                } else if (parser.type === 'static') {\n                    if (this.xpath.booleanValue(node, parser.selector)) {\n                        result[key] = parser.value;\n                    }\n                } else {\n                    try {\n                        let value = this.xpath.stringValue(node, parser.selector);\n                        if (value) {\n                            result[key] = value;\n                        }\n                    } catch(e) {\n                        // eslint-disable-next-line\n                        console.log(e);\n                    }\n                }\n            }\n        });\n        return result;\n    }\n\n    private parseContentMarks(node: Element, schema: any) {\n        // Parse the marks of a text node\n        let result = <any>[];\n        schema.forEach((entry: any) => {\n            if (entry.type === 'mark') {\n                let parsers = <any>[];\n                if (entry.parser) {\n                    parsers.push(entry.parser);\n                } else if (entry.parsers) {\n                    parsers = entry.parsers;\n                }\n                for (let idx = 0; idx < parsers.length; idx++) {\n                    if (this.xpath.booleanValue(node, parsers[idx].selector)) {\n                        let mark = <any>{\n                            type: entry.name\n                        };\n                        if (entry.attrs) {\n                            mark.attrs = this.parseContentAttributes(node, entry.attrs);\n                        }\n                        result.push(mark);\n                    }\n                }\n            }\n        });\n        return result;\n    }\n\n    private parseContentNode(node: Element, section: any) {\n        // Parse a single content node\n        let entries = Object.entries(section.schema);\n        for (let idx = 0; idx < entries.length; idx++) {\n            //let key = entries[idx][0];\n            let nodeSchema = <any>entries[idx][1];\n            let parsers = <any>[];\n            if (nodeSchema.parser) {\n                parsers.push(nodeSchema.parser);\n            } else if (nodeSchema.parsers) {\n                parsers = parsers.concat(nodeSchema.parsers);\n            }\n            for (let idx2 = 0; idx2 < parsers.length; idx2++) {\n                let parser = parsers[idx2];\n                if (this.xpath.firstNode(node, 'self::' + parser.selector) !== null) {\n                    // The first schema node where the parser selector matches is chosen as the result\n                    let result = <any>{\n                        type: nodeSchema.name\n                    };\n                    if (nodeSchema.attrs) {\n                        result.attrs = this.parseContentAttributes(node, nodeSchema.attrs);\n                    }\n                    if (nodeSchema.type === 'nested') {\n                        result.nestedDoc = true;\n                    }\n                    if (nodeSchema.type === 'inline') {\n                        // Inline nodes are either loaded as text nodes with marks or as complex text nodes\n                        if (nodeSchema.name === 'text') {\n                            result.text = this.xpath.stringValue(node, parser.text);\n                            result.marks = this.parseContentMarks(node, section.schema);\n                            if (node.children.length === 1) {\n                                let temp = this.parseContentNode(node.children[0], section);\n                                if (temp.text && temp.text !== '') {\n                                    result.text = temp.text;\n                                }\n                                result.marks = result.marks.concat(temp.marks);\n                            }\n                        } else {\n                            if (node.children.length === 0) {\n                                // Inline nodes without children need a virtual text node added if they have text\n                                if (this.xpath.stringValue(node, parser.text)) {\n                                    result.content = [\n                                        {\n                                            type: 'text',\n                                            text: this.xpath.stringValue(node, parser.text),\n                                            marks: this.parseContentMarks(node, section.schema)\n                                        }\n                                    ];\n                                }\n                            } else {\n                                let content = [];\n                                for (let idx3 = 0; idx3 < node.children.length; idx3++) {\n                                    let child = this.parseContentNode(node.children[idx3], section);\n                                    if (child) {\n                                        content.push(child);\n                                    }\n                                }\n                                result.content = content;\n                            }\n                        }\n                    } else {\n                        let content = [];\n                        for (let idx3 = 0; idx3 < node.children.length; idx3++) {\n                            let child = this.parseContentNode(node.children[idx3], section);\n                            if (child && !child.nestedDoc) {\n                                content.push(child);\n                            } else if (child && child.nestedDoc) {\n                                this.addNestedDoc(child);\n                            }\n                        }\n                        result.content = content;\n                    }\n                    return result;\n                }\n            }\n        }\n        return null;\n    }\n\n    private addNestedDoc(nestedParent: any) {\n        if (nestedParent.attrs && nestedParent.attrs.id) {\n            if (!this.nestedDocs[nestedParent.type]) {\n                this.nestedDocs[nestedParent.type] = {};\n            }\n            this.nestedDocs[nestedParent.type][nestedParent.attrs.id] = nestedParent;\n            let nestedDoc = {\n                type: 'doc',\n                content: nestedParent.content,\n            }\n            nestedParent.content = [nestedDoc];\n        }\n    }\n}\n","import Vue from \"vue\";\nimport Vuex from \"vuex\";\n\nimport { State, MetadataValueChange, MetadataMultiRowMove } from '@/interfaces';\nimport TEIMetadataParser from '@/util/TEIMetadataParser';\nimport TEITextParser from '@/util/TEITextParser';\nimport deepclone from '@/util/deepclone';\nimport get from '@/util/get';\n\nVue.use(Vuex);\n\nconst defaultState: State = {\n    settings: {\n        metadataSection: '',\n    },\n    sections: {},\n    content: {},\n    callbacks: {\n        save: undefined,\n        load: undefined,\n        autoLoad: undefined,\n    },\n};\n\nexport default new Vuex.Store({\n  state: defaultState,\n  mutations: {\n      init(state, config) {\n          state.sections = config.sections;\n          Object.keys(config.sections).forEach((key, idx) => {\n              if (config.sections[key].type === 'MetadataEditor') {\n                  state.settings.metadataSection = key;\n              }\n              Vue.set(state.content, key, {});\n              Vue.set(state.content[key], 'doc', null);\n              Vue.set(state.content[key], 'nested', {});\n          });\n          // @ts-ignore\n          if (window.TEIEditor && window.TEIEditor.callbacks) {\n              // @ts-ignore\n              Vue.set(state.callbacks, 'save', window.TEIEditor.callbacks.save);\n              // @ts-ignore\n              Vue.set(state.callbacks, 'load', window.TEIEditor.callbacks.load);\n              // @ts-ignore\n              Vue.set(state.callbacks, 'autoLoad', window.TEIEditor.callbacks.autoLoad);\n          }\n      },\n\n      setMetadata(state, metadata: any) {\n          Vue.set(state.content, state.settings.metadataSection, metadata);\n      },\n\n      setMetadataValue(state, payload: MetadataValueChange) {\n          // Set a metadata value. Will create missing data structures, except for missing multi-row fields\n          let metadata = state.content[state.settings.metadataSection];\n          if (metadata) {\n              metadata = deepclone(metadata);\n              let current = metadata;\n              let pathElements = payload.path.split('.');\n              while (pathElements.length > 0) {\n                  let pathElement = pathElements[0];\n                  if (pathElement[0] === '[' && pathElement[pathElement.length - 1] === ']' && Array.isArray(current)) {\n                      let pathIndex = Number.parseInt(pathElement.substring(1, pathElement.length - 1));\n                      if (pathIndex >= 0 && pathIndex < current.length) {\n                          if (pathElements.length > 1) {\n                              current = current[pathIndex];\n                          } else {\n                              current[pathIndex] = payload.value;\n                          }\n                      }\n                  } else {\n                      if (current[pathElement]) {\n                          if (pathElements.length > 1) {\n                              current = current[pathElement];\n                          } else {\n                              current[pathElement] = payload.value;\n                          }\n                      } else {\n                          if (pathElements.length > 1) {\n                              current[pathElement] = {};\n                              current = current[pathElement];\n                          } else {\n                              current[pathElement] = payload.value;\n                          }\n                      }\n                  }\n                  pathElements.splice(0, 1);\n              }\n              Vue.set(state.content, state.settings.metadataSection, metadata);\n          }\n      },\n\n      addMetadataMuliRow(state, payload: MetadataValueChange) {\n          let metadata = state.content[state.settings.metadataSection];\n          if (metadata) {\n              metadata = deepclone(metadata);\n              let parent = get(metadata, payload.path);\n              if (!parent) {\n                  let element = metadata;\n                  const path = payload.path.split('.');\n                  for (let idx = 0; idx < path.length; idx++) {\n                      if (element[path[idx]]) {\n                          element = element[path[idx]];\n                      } else {\n                          if (idx < path.length - 1) {\n                              element[path[idx]] = {}\n                          } else{\n                              element[path[idx]] = []\n                          }\n                          element = element[path[idx]];\n                      }\n                  }\n                  parent = get(metadata, payload.path);\n              }\n              parent.push(payload.value);\n              Vue.set(state.content, state.settings.metadataSection, metadata);\n          }\n      },\n\n      removeMetadataMultiRow(state, payload: MetadataValueChange) {\n          let metadata = state.content[state.settings.metadataSection];\n          if (metadata) {\n              metadata = deepclone(metadata);\n              let parent = get(metadata, payload.path);\n              if (parent && payload.value >= 0 && payload.value < parent.length) {\n                  parent.splice(payload.value, 1);\n                  Vue.set(state.content, state.settings.metadataSection, metadata);\n              }\n          }\n      },\n\n      moveMetadataMultiRow(state, payload: MetadataMultiRowMove) {\n          let metadata = state.content[state.settings.metadataSection];\n          if (metadata) {\n              metadata = deepclone(metadata);\n              let parent = get(metadata, payload.path);\n              if (parent && payload.idx >= 0 && payload.idx < parent.length && payload.idx + payload.move >= 0 && payload.idx + payload.move < parent.length) {\n                  let item = parent[payload.idx];\n                  parent.splice(payload.idx, 1);\n                  parent.splice(payload.idx + payload.move, 0, item);\n                  Vue.set(state.content, state.settings.metadataSection, metadata);\n              }\n          }\n      },\n\n      setTextDoc(state, payload: any) {\n          let path = payload.path.split('.');\n          if (path.length === 2) {\n              Vue.set(state.content[path[0]], path[1], payload.doc);\n          } else if(path.length === 4) {\n              Vue.set(state.content[path[0]].nested[path[2]][path[3]], 'content', [payload.doc]);\n          }\n      },\n\n      addNestedDoc(state, payload: any) {\n          let path = payload.path.split('.');\n          if (path.length === 4) {\n              if (!state.content[path[0]].nested[path[2]]) {\n                  Vue.set(state.content[path[0]].nested, path[2], {});\n              }\n              Vue.set(state.content[path[0]].nested[path[2]], path[3], {\n                  attrs: {\n                      id: path[3],\n                  },\n                  content: [\n                      payload.doc,\n                  ],\n                  nestedDoc: true,\n                  type: path[2],\n              });\n          }\n      },\n  },\n  actions: {\n      load({ commit, state }, sourceData: string) {\n          let domParser = new DOMParser();\n          let dom = domParser.parseFromString(sourceData, 'application/xml');\n          Vue.set(state, 'content', {});\n          Object.keys(state.sections).forEach((key, idx) => {\n              Vue.set(state.content, key, {});\n              Vue.set(state.content[key], 'doc', null);\n              Vue.set(state.content[key], 'nested', {});\n          });\n          Object.entries(state.sections).forEach(([key, config]) => {\n              if (config.type === 'MetadataEditor') {\n                  commit('setMetadata', (new TEIMetadataParser(dom, config)).get())\n              } else if (config.type === 'TextEditor') {\n                  let [doc, nestedDocs] = (new TEITextParser(dom, config)).get();\n                  commit('setTextDoc', { path: key + '.doc', doc: doc });\n                  Object.entries(nestedDocs).forEach(([nestedKey, docs]: any) => {\n                      Object.entries(docs).forEach(([docKey, doc]: any) => {\n                          commit('addNestedDoc', {path: key + '.nested.' + nestedKey + '.' + docKey, doc: doc.content[0]});\n                      });\n                  })\n              }\n          });\n      }\n  },\n  modules: {}\n});\n","import Vue from \"vue\";\nimport App from \"./App.vue\";\nimport store from \"./store\";\n\nVue.config.productionTip = false;\n\nnew Vue({\n  store,\n  render: h => h(App)\n}).$mount(\"#app\");\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TeiEditor.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TeiEditor.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}