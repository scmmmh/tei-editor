(function(e){function t(t){for(var n,o,s=t[0],c=t[1],l=t[2],d=0,h=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(h.length)h.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,s=1;s<a.length;s++){var c=a[s];0!==r[c]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},r={app:0},i=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},"37ba":function(e,t,a){},"6d73":function(e,t,a){"use strict";var n=a("37ba"),r=a.n(n);t["default"]=r.a},ba8f:function(e,t,a){},cd49:function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[e.config?a("tei-editor",{attrs:{config:e.config,autoLoadCallback:e.autoLoad,loadCallback:e.load},on:{save:e.save}}):e._e()],1)},i=[],o=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("d4ec")),s=a("bee2"),c=a("262e"),l=a("2caf"),u=a("9ab4"),d=a("60a3"),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"tei-editor"}},[a("nav",[a("aria-menubar",{scopedSlots:e._u([{key:"default",fn:function(t){var n=t.keyboardNav,r=t.mouseClickNav;return[a("ul",{attrs:{role:"menubar"}},[e.loadCallback?a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"-1"},on:{click:function(t){r(t),e.load()},keyup:n}},[e._v("Load")])]):e._e(),a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"-1"},on:{click:function(t){r(t),e.save()},keyup:n}},[e._v("Save")])]),e._l(e.config.sections,(function(t,i,o){return a("li",{key:o,attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"-1","aria-checked":i===e.currentSection?"true":"false"},on:{click:function(t){r(t),e.setCurrentSection(i)},keyup:n}},[e._v(e._s(t.label))])])}))],2)]}}])})],1),a("div",[e._l(e.config.sections,(function(t,n,r){return[n===e.currentSection?["MetadataEditor"===t.type?a("metadata-editor",{key:r,attrs:{config:t,value:e.metadata}}):e._e(),"TextEditor"===t.type?a("text-editor",{key:r,attrs:{config:t,nestedDocs:e.textData[n].nested},model:{value:e.textData[n].doc,callback:function(t){e.$set(e.textData[n],"doc",t)},expression:"textData[key].doc"}}):e._e()]:e._e()]}))],2)])},f=[],p=(a("4160"),a("4fad"),a("b64b"),a("159b"),a("3835")),v=a("5530"),b=a("b85c"),y=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"render",value:function(){if(this.$scopedSlots.default)return this.$scopedSlots.default({keyboardNav:this.keyboardNavigation,mouseClickNav:this.mouseClickNavigation})}},{key:"keyboardNavigation",value:function(e){var t=e.target;if(t)if(39===e.keyCode){var a=this.findNextMenuitem(this.getParentMenubar(t),t,"next");a&&a.focus()}else if(37===e.keyCode){var n=this.findNextMenuitem(this.getParentMenubar(t),t,"previous");n&&n.focus()}else if(38===e.keyCode||40===e.keyCode){var r,i=Object(b["a"])(t.parentElement.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;if("menu"===o.getAttribute("role")){o.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var s=this.findNextMenuitem(o,null,"next");s&&s.focus()}}}catch(h){i.e(h)}finally{i.f()}}else if(13===e.keyCode||32==e.keyCode){var c,l=Object(b["a"])(t.parentElement.children);try{for(l.s();!(c=l.n()).done;){var u=c.value;if("menu"===u.getAttribute("role"))if("false"===u.getAttribute("aria-hidden"))u.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false");else{u.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var d=this.findNextMenuitem(u,null,"next");if(d)return void d.focus()}}}catch(h){l.e(h)}finally{l.f()}t.click()}}},{key:"mouseClickNavigation",value:function(e){var t=e.target;if(t){var a,n=Object(b["a"])(t.parentElement.children);try{for(n.s();!(a=n.n()).done;){var r=a.value;if("menu"===r.getAttribute("role"))if("false"===r.getAttribute("aria-hidden"))r.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false");else{r.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var i=this.findNextMenuitem(r,null,"next");if(i)return void i.focus()}}}catch(o){n.e(o)}finally{n.f()}}}},{key:"getParentMenubar",value:function(e){return e?"menubar"===e.getAttribute("role")?e:this.getParentMenubar(e.parentElement):null}},{key:"findNextMenuitem",value:function(e,t,a){if(!e)return null;var n=[];if("next"===a)for(var r=e.children.length-1;r>=0;r--)n.push(e.children[r]);else for(var i=0;i<e.children.length;i++)n.push(e.children[i]);var o=0;t||(o=1);while(n.length>0){var s=n.pop();if(0===o&&s===t)o=1;else if(1===o&&"menuitem"===s.getAttribute("role")&&"true"!==s.getAttribute("aria-disabled"))return s;if("menu"!==s.getAttribute("role"))if("next"===a)for(var c=s.children.length-1;c>=0;c--)n.push(s.children[c]);else for(var l=0;l<s.children.length;l++)n.push(s.children[l])}return null}}]),a}(d["c"]);y=u["a"]([Object(d["a"])({})],y);var m,g,k=y,x=k,O=a("6d73"),j=a("2877");function T(e){this["$style"]=O["default"].locals||O["default"]}var A=Object(j["a"])(x,m,g,!1,T,null,null),N=A.exports,M=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"render",value:function(){if(this.$scopedSlots.default)return this.$scopedSlots.default({keyboardNav:this.keyboardNavigation,mouseClickNav:this.mouseClickNavigation})}},{key:"keyboardNavigation",value:function(e){var t=e.target;if(t)if(39===e.keyCode);else if(37===e.keyCode);else if(38===e.keyCode){var a=this.findNextMenuitem(this.getParentMenu(t),t,"previous");a&&a.focus()}else if(40===e.keyCode){var n=this.findNextMenuitem(this.getParentMenu(t),t,"next");n&&n.focus()}else if(13===e.keyCode||32==e.keyCode)if(t.getAttribute("aria-expanded")){var r,i=Object(b["a"])(t.parentElement.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;if("menu"===o.getAttribute("role"))if("false"===o.getAttribute("aria-hidden"))o.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false");else{o.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var s=this.findNextMenuitem(o,null,"next");s&&s.focus()}}}catch(h){i.e(h)}finally{i.f()}}else t.click();else if(27===e.keyCode){var c=this.getParentMenu(t);if(c){c.setAttribute("aria-hidden","true");var l,u=Object(b["a"])(c.parentElement.children);try{for(u.s();!(l=u.n()).done;){var d=l.value;"menuitem"===d.getAttribute("role")&&(d.setAttribute("aria-expanded","false"),d.focus())}}catch(h){u.e(h)}finally{u.f()}}}}},{key:"mouseClickNavigation",value:function(e){var t=e.target;if(t)if(t.getAttribute("aria-expanded")){var a,n=Object(b["a"])(t.parentElement.children);try{for(n.s();!(a=n.n()).done;){var r=a.value;if("menu"===r.getAttribute("role"))if("false"===r.getAttribute("aria-hidden"))r.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false");else{r.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var i=this.findNextMenuitem(r,null,"next");i&&i.focus()}}}catch(u){n.e(u)}finally{n.f()}}else{var o=this.getParentMenu(t);if(o){o.setAttribute("aria-hidden","true");var s,c=Object(b["a"])(o.parentElement.children);try{for(c.s();!(s=c.n()).done;){var l=s.value;"menuitem"===l.getAttribute("role")&&(l.setAttribute("aria-expanded","false"),l.focus())}}catch(u){c.e(u)}finally{c.f()}}}}},{key:"getParentMenu",value:function(e){return e?"menu"===e.getAttribute("role")?e:this.getParentMenu(e.parentElement):null}},{key:"getParentMenuOrMenubar",value:function(e){return e?"menu"===e.getAttribute("role")||"menubar"===e.getAttribute("role")?e:this.getParentMenuOrMenubar(e.parentElement):null}}]),a}(N);M=u["a"]([Object(d["a"])({})],M);var E,S,w=M,_=w,C=Object(j["a"])(_,E,S,!1,null,null,null),D=C.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"metadata-editor"},e._l(e.config.ui,(function(t,n){return a("section",{key:n},[a("h2",[e._v(e._s(t.label))]),e._l(t.entries,(function(t,n){return a("div",{key:n},[a("metadata-field",{attrs:{config:t,value:e.value}})],1)}))],2)})),0)},L=[],H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",["single-text"==e.config.type?[a("label",[a("span",{staticClass:"label-text"},[e._v(e._s(e.config.label))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.localValue,expression:"localValue"}],attrs:{type:"text"},domProps:{value:e.localValue},on:{input:function(t){t.target.composing||(e.localValue=t.target.value)}}})])]:"multi-row"==e.config.type?[a("ol",{staticClass:"multi-row"},e._l(e.localValue,(function(t,n){return a("li",{key:n},[e._l(e.config.entries,(function(e,n){return a("metadata-field",{key:n,attrs:{config:e,value:t}})})),a("aria-menubar",{attrs:{items:e.modifyMenuItems(n)},on:{action:e.menuAction}}),a("aria-menubar",{scopedSlots:e._u([{key:"default",fn:function(t){var r=t.keyboardNav;return[a("ul",{attrs:{role:"menubar"}},[a("li",{attrs:{role:"presentation"}},[a("a",0===n?{attrs:{role:"menuitem","aria-disabled":!0}}:{attrs:{role:"menuitem",tabindex:1===e.value.length?null:0},on:{click:function(t){return e.menuAction("move-up:"+n)},keyup:r}},[a("svg",{attrs:{viewBox:"0 0 24 24","aria-label":"Move up"}},[a("path",{attrs:{d:"M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M16.59,15.71L12,11.12L7.41,15.71L6,14.29L12,8.29L18,14.29L16.59,15.71Z"}})])])]),a("li",{attrs:{role:"presentation"}},[n===e.localValue.length-1?a("a",{attrs:{role:"menuitem","aria-disabled":!0}},[a("svg",{attrs:{viewBox:"0 0 24 24","aria-label":"Move down"}},[a("path",{attrs:{d:"M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M12,15.71L6,9.71L7.41,8.29L12,12.88L16.59,8.29L18,9.71L12,15.71Z"}})])]):a("a",{attrs:{role:"menuitem",tabindex:1===e.value.length?null:0},on:{click:function(t){return e.menuAction("move-down:"+n)},keyup:r}},[a("svg",{attrs:{viewBox:"0 0 24 24","aria-label":"Move down"}},[a("path",{attrs:{d:"M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M12,15.71L6,9.71L7.41,8.29L12,12.88L16.59,8.29L18,9.71L12,15.71Z"}})])])]),a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:1===e.value.length?0:-1},on:{click:function(t){return e.menuAction("delete:"+n)},keyup:r}},[a("svg",{attrs:{viewBox:"0 0 24 24","aria-label":"Delete"}},[a("path",{attrs:{d:"M17,13H7V11H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"}})])])])])]}}],null,!0)})],2)})),0),a("aria-menubar",{scopedSlots:e._u([{key:"default",fn:function(t){var n=t.keyboardNav;return[a("ul",{attrs:{role:"menubar"}},[a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"0"},on:{click:function(t){return e.menuAction("add")},keyup:n}},[a("svg",{attrs:{viewBox:"0 0 24 24","aria-label":"Add"}},[a("path",{attrs:{d:"M17,13H13V17H11V13H7V11H11V7H13V11H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"}})])])])])]}}])})]:e._e(),"multi-field"==e.config.type?[a("ol",{staticClass:"multi-field"},e._l(e.config.entries,(function(t,n){return a("li",{key:n},[a("metadata-field",{attrs:{config:t,value:e.value}})],1)})),0)]:e._e()],2)},P=[];a("c975"),a("a15b"),a("fb6a"),a("a434"),a("a9e3"),a("25eb"),a("ac1f"),a("1276");function I(e,t){var a=t.split(".");while(e&&a.length>0){if("["===a[0][0]&&"]"===a[0][a[0].length-1]){var n=Number.parseInt(a[0].substring(1,a[0].length-1));n>=0&&n<e.length&&(e=e[n])}else e=e[a[0]];a=a.slice(1)}return e}var $=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.addMenuItems=[{label:'<svg viewBox="0 0 24 24" aria-label="Add"><path d="M17,13H13V17H11V13H7V11H11V7H13V11H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z" /></svg>',action:"add"}],e}return Object(s["a"])(a,[{key:"modifyMenuItems",value:function(e){return[{label:'<svg viewBox="0 0 24 24" aria-label="Move up"><path d="M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M16.59,15.71L12,11.12L7.41,15.71L6,14.29L12,8.29L18,14.29L16.59,15.71Z" /></svg>',action:"move-up:"+e,disabled:0===e},{label:'<svg viewBox="0 0 24 24" aria-label="Move down"><path d="M19,3H5A2,2 0 0,0 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5A2,2 0 0,0 19,3M12,15.71L6,9.71L7.41,8.29L12,12.88L16.59,8.29L18,9.71L12,15.71Z" /></svg>',action:"move-down:"+e,disabled:e===this.localValue.length-1},{label:'<svg viewBox="0 0 24 24" aria-label="Delete"><path d="M17,13H7V11H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z" /></svg>',action:"delete:"+e}]}},{key:"menuAction",value:function(e){if("add"===e){var t={};this.config.entries&&this.config.entries.forEach((function(e){var a=e.path;"single-text"===e.type?t[a]="":"multi-row"===e.type?t[a]=[]:"multi-field"===e.type&&e.entries.forEach((function(e){var a=e.path;if("single-text"===e.type)for(var n=a.split("."),r=t,i=0;i<n.length;i++)i<n.length-1?(r[n[i]]={},r=r[n[i]]):r[n[i]]="";else"multi-row"===e.type&&(t[a]=[])}))})),this.localValue.push(t)}else if(0===e.indexOf("move-up:")){var a=Number.parseInt(e.substring(8)),n=this.localValue.splice(a,1);this.localValue.splice(a-1,0,n[0])}else if(0===e.indexOf("move-down:")){var r=Number.parseInt(e.substring(10)),i=this.localValue.splice(r+1,1);this.localValue.splice(r,0,i[0])}else 0===e.indexOf("delete:")&&this.localValue.splice(Number.parseInt(e.substring(7)),1)}},{key:"localValue",get:function(){return I(this.value,this.config.path)},set:function(e){var t=this.config.path.split(".");1===t.length?d["c"].set(this.value,t[0],e):d["c"].set(I(this.value,t.slice(0,t.length-1).join(".")),t[t.length-1],e)}}]),a}(d["c"]);u["a"]([Object(d["b"])()],$.prototype,"config",void 0),u["a"]([Object(d["b"])()],$.prototype,"value",void 0),$=u["a"]([Object(d["a"])({components:{AriaMenubar:N},name:"metadata-field"})],$);var R=$,B=R,F=Object(j["a"])(B,H,P,!1,null,null,null),Z=F.exports,U=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return a}(d["c"]);u["a"]([Object(d["b"])()],U.prototype,"config",void 0),u["a"]([Object(d["b"])()],U.prototype,"value",void 0),U=u["a"]([Object(d["a"])({components:{MetadataField:Z}})],U);var z=U,J=z,X=Object(j["a"])(J,V,L,!1,null,null,null),Y=X.exports,W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"text-editor"},[a("div",{staticClass:"editor"}),a("aria-menubar",{scopedSlots:e._u([{key:"default",fn:function(t){var n=t.keyboardNav;return[a("div",{staticClass:"sidebar"},e._l(e.sidebar,(function(t,r){return a("div",{key:r,class:{"is-active":t.active}},[a("h2",[e._v(e._s(t.label))]),e._l(t.entities,(function(t,r){return["list"===t.type?a("ul",{key:r},e._l(t.entities,(function(t,n){return a("li",{key:n,attrs:{role:"presentation"}},[a("label",[a("span",{domProps:{innerHTML:e._s(t.label)}}),"setNodeAttrString"===t.type?a("input",{domProps:{value:t.value},on:{change:function(a){return e.menuAction(t,a)}}}):e._e()])])})),0):"menubar"===t.type?a("ul",{key:r,attrs:{role:"menubar"}},e._l(t.entities,(function(t,r){return a("li",{key:r,class:"separator"===t.type?"separator":null,attrs:{role:"presentation"}},["setNodeType"===t.type||"setNodeAttrValue"===t.type?a("a",{attrs:{role:"menuitem",tabindex:t.tabindex,"aria-label":t.ariaLabel,title:t.ariaLabel,"aria-checked":t.checked},domProps:{innerHTML:e._s(t.label)},on:{keyup:n,click:function(a){return e.menuAction(t)}}}):"selectNodeAttr"===t.type?a("select",{attrs:{role:"menuitem",tabindex:t.tabindex},on:{keyup:n,change:function(a){return e.menuAction(t,a)}}},e._l(t.values,(function(t){return a("option",{key:t.value,domProps:{value:t.value,selected:t.checked,innerHTML:e._s(t.label)}})})),0):"toggleMark"===t.type?a("a",{attrs:{role:"menuitem",tabindex:t.tabindex,"aria-label":t.ariaLabel,title:t.ariaLabel,"aria-checked":t.checked},domProps:{innerHTML:e._s(t.label)},on:{keyup:n,click:function(a){return e.menuAction(t)}}}):"selectMarkAttr"===t.type?a("select",{attrs:{role:"menuitem",tabindex:t.tabindex},on:{keyup:n,change:function(a){return e.menuAction(t,a)}}},e._l(t.values,(function(t){return a("option",{key:t.value,domProps:{value:t.value,selected:t.checked,innerHTML:e._s(t.label)}})})),0):"editNestedDoc"===t.type?a("a",{attrs:{role:"menuitem",tabindex:t.tabindex,"aria-label":t.ariaLabel,title:t.ariaLabel},domProps:{innerHTML:e._s(t.label)},on:{keyup:n,click:function(a){return e.menuAction(t)}}}):"closeNested"===t.type?a("a",{attrs:{role:"menuitem",tabindex:t.tabindex,"aria-label":t.ariaLabel,title:t.ariaLabel},domProps:{innerHTML:e._s(t.label)},on:{keyup:n,click:function(t){return e.$emit("close")}}}):"linkNestedDoc"===t.type?a("select",{attrs:{role:"menuitem",tabindex:t.tabindex},on:{keyup:n,change:function(a){return e.menuAction(t,a)}}},e._l(t.values,(function(t){return a("option",{key:t.value,domProps:{value:t.value,selected:t.checked,innerHTML:e._s(t.label)}})})),0):e._e()])})),0):e._e()]}))],2)})),0)]}}])}),e.showNested?a("div",{staticClass:"nested"},[a("text-editor",{attrs:{config:e.config,nestedDocs:e.nestedDocs,nested:e.nestedSettings},on:{close:e.closeNestedEditor},model:{value:e.nestedDocs[e.nestedSettings.type][e.nestedSettings.id].content[0],callback:function(t){e.$set(e.nestedDocs[e.nestedSettings.type][e.nestedSettings.id].content,0,t)},expression:"nestedDocs[nestedSettings.type][nestedSettings.id].content[0]"}})],1):e._e()],1)},q=[],G=(a("d81d"),a("b0c0"),a("bf19"),a("304a")),K=a("5313"),Q=a("576a"),ee=a("0010"),te=a("8726"),ae=a("7f06"),ne=a("53ca");function re(e){if(void 0!==e){if(null===e)return null;if(Array.isArray(e))return e.map((function(e){return re(e)}));if("object"===Object(ne["a"])(e)){var t={};return Object.keys(e).forEach((function(a){t[a]=re(e[a])})),t}return e}}a("7db0");var ie=a("986d"),oe=a("0ac0");function se(e){var t={doc:{content:"block+"}};return e.forEach((function(e){"block"===e.type?t[e.name]={content:"inline*",group:"block",attrs:e.attrs,parseDOM:[{tag:"div.node-".concat(e.name),node:e.name,getAttrs:function(t){var a={};return e.attrs&&Object.keys(e.attrs).forEach((function(e){var n=t.getAttribute("data-".concat(e));n&&(a[e]=n)})),a}}],toDOM:function(t){var a={class:"node-".concat(e.name)};return Object.entries(t.attrs).forEach((function(e){var t=Object(p["a"])(e,2),n=t[0],r=t[1];a["data-".concat(n)]=r})),["div",a,0]}}:"wrapping"===e.type?t[e.name]={content:e.content+"+",group:"block",attrs:e.attrs,parseDOM:[{tag:"div.node-".concat(e.name),getAttrs:function(t){var a={};return e.attrs&&Object.keys(e.attrs).forEach((function(e){var n=t.getAttribute("data-".concat(e));n&&(a[e]=n)})),a}}],toDOM:function(t){var a={class:"node-".concat(e.name)};return Object.entries(t.attrs).forEach((function(e){var t=Object(p["a"])(e,2),n=t[0],r=t[1];a["data-".concat(n)]=r})),["div",a,0]}}:"inline"===e.type&&"text"===e.name?t.text={group:"inline"}:"inline"===e.type&&"text"!==e.name&&(t[e.name]={content:"inline*",group:"inline",inline:!0,attrs:e.attrs,parseDOM:[{tag:"span.node-".concat(e.name),getAttrs:function(t){var a={};return e.attrs&&Object.keys(e.attrs).forEach((function(e){var n=t.getAttribute("data-".concat(e));n&&(a[e]=n)})),a}}],toDOM:function(t){var a={class:"node-".concat(e.name)};return Object.entries(t.attrs).forEach((function(e){var t=Object(p["a"])(e,2),n=t[0],r=t[1];a["data-".concat(n)]=r})),["span",a,0]}})})),t}function ce(e){var t={};return e.forEach((function(e){"mark"===e.type&&(t[e.name]={attrs:e.attrs,parseDOM:[{tag:"span.mark-".concat(e.name),getAttrs:function(t){var a={};return e.attrs&&Object.keys(e.attrs).forEach((function(e){var n=t.getAttribute("data-".concat(e));n&&(a[e]=n)})),a}}],toDOM:function(t){var a={class:"mark-".concat(e.name)};return Object.entries(t.attrs).forEach((function(e){var t=Object(p["a"])(e,2),n=t[0],r=t[1];r&&(a["data-".concat(n)]=r)})),["span",a,0]}})})),t}function le(e,t){if(!e||!t)return!1;var a=e.parent.childAfter(e.parentOffset);if(!a.node)return!1;var n=a.node.marks.find((function(e){return e.type===t}));if(!n)return!1;var r=e.index(),i=e.start()+a.offset,o=r+1,s=i+a.node.nodeSize;while(r>0&&n.isInSet(e.parent.child(r-1).marks))r-=1,i-=e.parent.child(r).nodeSize;while(o<e.parent.childCount&&n.isInSet(e.parent.child(o).marks))s+=e.parent.child(o).nodeSize,o+=1;return{from:i,to:s}}function ue(e,t){return function(a,n){var r=a.tr,i=a.selection,o=a.doc,s=i.from,c=i.to,l=i.$from,u=i.empty;if(u){var d=le(l,e);d&&(s=d.from,c=d.to)}var h=o.rangeHasMark(s,c,e);return h&&r.removeMark(s,c,e),r.addMark(s,c,e.create(t)),n(r)}}function de(e){return function(t,a){var n=t.tr,r=t.selection,i=t.doc,o=r.from,s=r.to,c=r.$from,l=r.empty;if(l){var u=le(c,e);u&&(o=u.from,s=u.to)}var d=i.rangeHasMark(o,s,e);if(d)return n.removeMark(o,s,e),a(n)}}function he(e,t){return function(a,n){var r=Object(ie["findSelectedNodeOfType"])(e)(a.selection)||Object(ie["findParentNodeOfType"])(e)(a.selection);if(r){var i=a.tr.replaceRangeWith(r.pos,r.pos+r.node.nodeSize,e.create(t,r.node.content));n(i)}}}function fe(e,t){return function(a,n){var r=a.selection,i=r.$from,o=r.$to,s=i.blockRange(o);if(!s)return!1;var c=a.tr.setBlockType(s.$from.pos,s.$to.pos,t);c=c.wrap(s,[{type:e}]),n(c)}}function pe(e){return function(t,a){var n=t.selection,r=n.$from,i=n.$to,o=r.blockRange(i),s=o&&Object(oe["j"])(o);if(!o||null===s||void 0===s)return!1;var c=t.tr.lift(o,s);c=c.setBlockType(o.$from.pos,o.$to.pos,e),a(c)}}function ve(e,t,a){for(var n=0;n<t.length;n++)if("wrapping"===t[n].type&&Object(ie["findParentNodeOfType"])(a.nodes[t[n].name])(e.selection))return!0;return!1}var be=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.editor=null,e.showNested=!1,e.nestedSettings=null,e.stateDebounce=null,e.internalUpdate=!1,e.active={},e}return Object(s["a"])(a,[{key:"mounted",value:function(){var e=this;this.editor=new Q["c"](this.$el.querySelector(".editor"),{state:K["EditorState"].create({schema:this.editorSchema,doc:this.value?this.editorSchema.nodeFromJSON(this.value):null,plugins:this.editorPlugins}),dispatchTransaction:function(t){if(e.editor){var a=e.editor.state.apply(t);e.stateChanged(a,t),e.editor.updateState(a)}}})}},{key:"beforeDestroy",value:function(){this.editor&&this.editor.destroy()}},{key:"updatedDoc",value:function(){!this.internalUpdate&&this.editor&&this.editor.updateState(K["EditorState"].create({schema:this.editorSchema,doc:this.editorSchema.nodeFromJSON(this.value),plugins:this.editorPlugins})),this.internalUpdate=!1}},{key:"stateChanged",value:function(e,t){var a=this;null!==this.stateDebounce&&clearTimeout(this.stateDebounce),this.stateDebounce=window.setTimeout((function(){var t=e.selection,n=t.from,r=t.to,i={};e.doc.nodesBetween(n,r,(function(e){i[e.type.name]=e.attrs,e.marks&&e.marks.forEach((function(e){e.attrs?i[e.type.name]=e.attrs:i[e.type.name]={}}))})),a.active=i,a.internalUpdate=!0,a.$emit("input",e.doc.toJSON())}),t.steps.length>0?500:50)}},{key:"menuAction",value:function(e,t){var a=this;if(this.editor)if("setNodeType"===e.type&&e.nodeType)if(this.editorSchema.nodes[e.nodeType].isInline){var n=this.editor.state.selection.content();if(this.active[e.nodeType]){var r=function t(n){return n.type.isBlock?a.editorSchema.nodes[n.type.name].create({},a.walkFragment(n.content,t)):n.type.isInline&&n.type.name===e.nodeType?a.editorSchema.text(n.textContent):n},i=this.walkFragment(n.content,r);this.editor.dispatch(this.editor.state.tr.replaceSelection(new G["Slice"](i,n.openStart,n.openEnd)))}else{var o=function t(n){return n.type.isBlock?a.editorSchema.nodes[n.type.name].create(n.attrs,a.walkFragment(n.content,t)):n.type.isText&&e.nodeType?a.editorSchema.nodes[e.nodeType].create({},n):n.type.isInline&&e.nodeType?a.editorSchema.nodes[e.nodeType].create(n.attrs,n.content):n},s=this.walkFragment(n.content,o);this.editor.dispatch(this.editor.state.tr.replaceSelection(new G["Slice"](s,n.openStart,n.openEnd)))}}else if(this.isWrappingType(e.nodeType)){for(var c="",l=0;l<this.config.schema.length;l++)this.config.schema[l].name===e.nodeType&&"wrapping"===this.config.schema[l].type&&(c=this.config.schema[l].content);fe(this.editorSchema.nodes[e.nodeType],this.editorSchema.nodes[c])(this.editor.state,this.editor.dispatch)}else ve(this.editor.state,this.config.schema,this.editorSchema)?pe(this.editorSchema.nodes[e.nodeType])(this.editor.state,this.editor.dispatch):Object(ee["b"])(this.editorSchema.nodes[e.nodeType],{})(this.editor.state,this.editor.dispatch);else if("setNodeAttrValue"!==e.type&&"selectNodeAttr"!==e.type&&"setNodeAttrString"!==e.type||!e.nodeType){if("toggleMark"===e.type&&e.nodeType)Object(ee["c"])(this.editorSchema.marks[e.nodeType])(this.editor.state,this.editor.dispatch);else if("selectMarkAttr"===e.type&&e.nodeType){var u={};this.active[e.nodeType]&&(u=re(this.active[e.nodeType])),e.attr&&(t&&t.target?u[e.attr]=t.target.value:e.value&&(u[e.attr]=e.value)),""===u[e.attr]?de(this.editorSchema.marks[e.nodeType])(this.editor.state,this.editor.dispatch):ue(this.editorSchema.marks[e.nodeType],u)(this.editor.state,this.editor.dispatch)}else if("linkNestedDoc"===e.type&&e.nodeType){var h={};this.active[e.nodeType]&&(h=re(this.active[e.nodeType])),e.attr&&(t&&t.target?h[e.attr]=t.target.value:e.value&&(h[e.attr]=e.value)),he(this.editorSchema.nodes[e.nodeType],h)(this.editor.state,this.editor.dispatch)}else if("editNestedDoc"===e.type&&e.nodeType&&e.attr&&e.targetNodeType&&this.active[e.nodeType]){var f=this.active[e.nodeType][e.attr];if(!f){var p=this.nestedDocs[e.targetNodeType];f=e.targetNodeType+"-1";var v=1;while(p&&p[f])v+=1,f=e.targetNodeType+"-"+v;var b={};this.active[e.nodeType]&&(b=re(this.active[e.nodeType])),e.attr&&(b[e.attr]=f),he(this.editorSchema.nodes[e.nodeType],b)(this.editor.state,this.editor.dispatch),d["c"].set(this.nestedDocs[e.targetNodeType],f,{type:"doc",content:[{type:"paragraph",content:[]}]})}this.showNested=!0,this.nestedSettings={type:e.targetNodeType,id:f}}}else{var y={};this.active[e.nodeType]&&(y=re(this.active[e.nodeType])),e.attr&&(t&&t.target?y[e.attr]=t.target.value:e.value&&(y[e.attr]=e.value)),this.editorSchema.nodes[e.nodeType].isInline?he(this.editorSchema.nodes[e.nodeType],y)(this.editor.state,this.editor.dispatch):Object(ee["b"])(this.editorSchema.nodes[e.nodeType],y)(this.editor.state,this.editor.dispatch)}}},{key:"closeNestedEditor",value:function(){this.showNested=!1,this.nestedSettings=null}},{key:"walkFragment",value:function(e,t){for(var a=0;a<e.childCount;a++)e=e.replaceChild(a,t(e.child(a)));return e}},{key:"isWrappingType",value:function(e){for(var t=0;t<this.config.schema.length;t++)if(this.config.schema[t].name===e&&"wrapping"===this.config.schema[t].type)return!0;return!1}},{key:"editorSchema",get:function(){return new G["Schema"]({nodes:se(this.config.schema),marks:ce(this.config.schema)})}},{key:"editorPlugins",get:function(){return[Object(te["a"])(),Object(ae["b"])({"Mod-z":te["c"],"Mod-y":te["b"]}),Object(ae["b"])(ee["a"])]}},{key:"ui",get:function(){return this.nested?this.config.ui[this.nested.type]:this.config.ui.doc}},{key:"sidebar",get:function(){var e=this;return this.ui.map((function(t){return{label:t.label,active:!t.condition||e.active[t.condition.activeType],entities:t.entities?t.entities.map((function(t){return{type:t.type,entities:t.entities.map((function(t,a){var n={type:t.type,label:t.label,nodeType:t.nodeType||t.markType,attr:t.attr,value:t.value?t.value:"",values:[],checked:"false",tabindex:0===a?0:-1,ariaLabel:t.ariaLabel,targetNodeType:t.targetNodeType};return"setNodeType"===t.type?n.checked=t.nodeType&&e.active[t.nodeType]?"true":"false":"setNodeAttrValue"===t.type?n.checked=t.nodeType&&t.attr&&e.active[t.nodeType]&&e.active[t.nodeType][t.attr]===t.value?"true":"false":"selectNodeAttr"===t.type?n.values=t.values.map((function(a){return{value:a.value,label:a.label,checked:t.nodeType&&t.attr&&e.active[t.nodeType]&&e.active[t.nodeType][t.attr]===a.value?"selected":null}})):"toggleMark"===t.type?n.checked=t.markType&&e.active[t.markType]?"true":"false":"selectMarkAttr"===t.type?n.values=t.values.map((function(a){return{value:a.value,label:a.label,checked:t.markType&&t.attr&&e.active[t.markType]&&e.active[t.markType][t.attr]===a.value?"selected":null}})):"linkNestedDoc"===t.type?t.targetNodeType&&e.nestedDocIds[t.targetNodeType]&&(n.values=e.nestedDocIds[t.targetNodeType].map((function(a){return{value:a.value,label:a.label,checked:t.nodeType&&t.attr&&e.active[t.nodeType]&&e.active[t.nodeType][t.attr]===a.value?"selected":null}}))):"setNodeAttrString"===t.type&&(n.value=t.nodeType&&e.active[t.nodeType]&&e.active[t.nodeType][t.attr]?e.active[t.nodeType][t.attr]:""),n}))}})):[]}}))}},{key:"nestedDocIds",get:function(){var e={};return Object.entries(this.nestedDocs).forEach((function(t){var a=Object(p["a"])(t,2),n=a[0],r=a[1];e[n]=Object.keys(r).map((function(e){return{label:e,value:e}})),e[n].splice(0,0,{label:"New",value:""})})),e}}]),a}(d["c"]);u["a"]([Object(d["b"])()],be.prototype,"config",void 0),u["a"]([Object(d["b"])()],be.prototype,"value",void 0),u["a"]([Object(d["b"])()],be.prototype,"nestedDocs",void 0),u["a"]([Object(d["b"])()],be.prototype,"nested",void 0),u["a"]([Object(d["d"])("value")],be.prototype,"updatedDoc",null),be=u["a"]([Object(d["a"])({components:{AriaMenubar:N},name:"text-editor"})],be);var ye=be,me=ye,ge=Object(j["a"])(me,W,q,!1,null,null,null),ke=ge.exports;function xe(e){return"tei"===e?"http://www.tei-c.org/ns/1.0":"xml"===e?"http://www.w3.org/XML/1998/namespace":"http://www.tei-c.org/ns/1.0"}var Oe=function(){function e(t){Object(o["a"])(this,e),this.dom=t}return Object(s["a"])(e,[{key:"evaluate",value:function(e,t,a){return this.dom.evaluate(t,e,xe,a,null)}},{key:"firstNode",value:function(e,t){return this.evaluate(e,t,XPathResult.FIRST_ORDERED_NODE_TYPE).singleNodeValue}},{key:"nodeIterator",value:function(e,t){return this.evaluate(e,t,XPathResult.ORDERED_NODE_ITERATOR_TYPE)}},{key:"stringValue",value:function(e,t){return this.evaluate(e,t,XPathResult.STRING_TYPE).stringValue}},{key:"booleanValue",value:function(e,t){return this.evaluate(e,t,XPathResult.BOOLEAN_TYPE).booleanValue}},{key:"numberValue",value:function(e,t){return this.evaluate(e,t,XPathResult.NUMBER_TYPE).numberValue}}]),e}(),je=function(){function e(t,a){Object(o["a"])(this,e),this.dom=t,this.xpath=new Oe(this.dom),this.config=a}return Object(s["a"])(e,[{key:"get",value:function(){if(!this.data){var e=this.xpath.firstNode(this.dom.documentElement,"/tei:TEI/tei:teiHeader");this.data={};for(var t=0;t<this.config.schema.length;t++){var a=this.parseHeaderNode(e,this.config.schema[t]);a&&(this.data[this.config.schema[t].tag.substring(4)]=a)}}return this.data}},{key:"parseHeaderNode",value:function(e,t){var a=this.xpath.nodeIterator(e,t.tag),n=[],r=a.iterateNext();while(r){for(var i={_attrs:{},_text:0===r.children.length?this.xpath.stringValue(r,"text()"):null},o=0;o<r.attributes.length;o++)i._attrs[r.attributes[o].name]=r.attributes[o].value;if(t.children)for(var s=0;s<t.children.length;s++){var c=this.parseHeaderNode(r,t.children[s]);c&&(i[t.children[s].tag.substring(t.children[s].tag.indexOf(":")+1)]=c)}n.push(i),r=a.iterateNext()}return 0===n.length?null:t.multiple?n:n[0]}}]),e}(),Te=(a("99af"),function(){function e(t,a){Object(o["a"])(this,e),this.dom=t,this.xpath=new Oe(this.dom),this.config=a}return Object(s["a"])(e,[{key:"get",value:function(){if(!this.doc&&(this.doc={type:"doc",content:[]},this.nestedDocs={},this.config.parser&&this.config.parser.selector)){var e=this.xpath.firstNode(this.dom.documentElement,this.config.parser.selector);if(e)for(var t=0;t<e.children.length;t++){var a=this.parseContentNode(e.children[t],this.config);a&&!a.nestedDoc?this.doc.content.push(a):a&&a.nestedDoc&&this.addNestedDoc(a)}}return 0===this.doc.content.length?[null,{}]:[this.doc,this.nestedDocs]}},{key:"parseContentAttributes",value:function(e,t){var a=this,n={};return Object.entries(t).forEach((function(t){var r=Object(p["a"])(t,2),i=r[0],o=r[1],s=[];o.parser?s.push(o.parser):o.parsers&&(s=o.parsers);for(var c=0;c<s.length;c++){var l=s[c];if("boolean"===l.type)n[i]=a.xpath.booleanValue(e,l.selector);else if("number"===l.type)try{n[i]=a.xpath.numberValue(e,l.selector)}catch(d){console.log(d)}else if("static"===l.type)a.xpath.booleanValue(e,l.selector)&&(n[i]=l.value);else try{var u=a.xpath.stringValue(e,l.selector);u&&(n[i]=u)}catch(d){console.log(d)}}})),n}},{key:"parseContentMarks",value:function(e,t){var a=this,n=[];return t.forEach((function(t){if("mark"===t.type){var r=[];t.parser?r.push(t.parser):t.parsers&&(r=t.parsers);for(var i=0;i<r.length;i++)if(a.xpath.booleanValue(e,r[i].selector)){var o={type:t.name};t.attrs&&(o.attrs=a.parseContentAttributes(e,t.attrs)),n.push(o)}}})),n}},{key:"parseContentNode",value:function(e,t){for(var a=Object.entries(t.schema),n=0;n<a.length;n++){var r=a[n][1],i=[];r.parser?i.push(r.parser):r.parsers&&(i=i.concat(r.parsers));for(var o=0;o<i.length;o++){var s=i[o];if(null!==this.xpath.firstNode(e,"self::"+s.selector)){var c={type:r.name};if(r.attrs&&(c.attrs=this.parseContentAttributes(e,r.attrs)),"nested"===r.type&&(c.nestedDoc=!0),"inline"===r.type)if("text"===r.name){if(c.text=this.xpath.stringValue(e,s.text),c.marks=this.parseContentMarks(e,t.schema),1===e.children.length){var l=this.parseContentNode(e.children[0],t);l.text&&""!==l.text&&(c.text=l.text),c.marks=c.marks.concat(l.marks)}}else if(0===e.children.length)this.xpath.stringValue(e,s.text)&&(c.content=[{type:"text",text:this.xpath.stringValue(e,s.text),marks:this.parseContentMarks(e,t.schema)}]);else{for(var u=[],d=0;d<e.children.length;d++){var h=this.parseContentNode(e.children[d],t);h&&u.push(h)}c.content=u}else{for(var f=[],p=0;p<e.children.length;p++){var v=this.parseContentNode(e.children[p],t);v&&!v.nestedDoc?f.push(v):v&&v.nestedDoc&&this.addNestedDoc(v)}c.content=f}return c}}}return null}},{key:"addNestedDoc",value:function(e){if(e.attrs&&e.attrs.id){this.nestedDocs[e.type]||(this.nestedDocs[e.type]={}),this.nestedDocs[e.type][e.attrs.id]=e;var t={type:"doc",content:e.content};e.content=[t]}}}]),e}()),Ae=(a("4de4"),a("25f0"),a("6062"),a("5319"),function(){function e(){Object(o["a"])(this,e)}return Object(s["a"])(e,[{key:"serialise",value:function(e,t){var a=this,n={node:"tei:TEI",attrs:{"xmlns:tei":["http://www.tei-c.org/ns/1.0"]},children:[]};Object.entries(t).forEach((function(t){var r=Object(p["a"])(t,2),i=r[0],o=r[1];"MetadataEditor"===o.type&&a.mergeTrees(n,a.serialiseHeader(e[i],o))})),Object.entries(t).forEach((function(t){var r=Object(p["a"])(t,2),i=r[0],o=r[1];"TextEditor"===o.type&&a.mergeTrees(n,a.serialiseSingleText(e[i],o))}));var r=this.toString(n,"");return r.splice(0,0,'<?xml version="1.0" encoding="UTF-8"?>'),r.push(""),r.join("\n")}},{key:"mergeTrees",value:function(e,t){if(e&&t)for(var a=0;a<t.children.length;a++){for(var n=!1,r=0;r<e.children.length;r++)e.children[r].node===t.children[a].node&&this.objectsMatch(e.children[r].attrs,t.children[a].attrs)&&(this.mergeTrees(e.children[r],t.children[a]),n=!0);n||e.children.push(t.children[a])}}},{key:"objectsMatch",value:function(e,t){var a=this;if(e&&t){if(Object(ne["a"])(e)!==Object(ne["a"])(t))return!1;if("string"===typeof e||"number"===typeof e||"boolean"===typeof e)return e===t;var n=Object.keys(e),r=Object.keys(t);return n.forEach((function(n){return!(r.indexOf(n)<0)&&(!!a.objectsMatch(e[n],t[n])&&void r.splice(r.indexOf(n),1))})),!(r.length>0)}return!e&&!t}},{key:"serialiseSingleText",value:function(e,t){var a=this;if(e){var n=t.serialiser.tag.split("/");this.nested={};var r={node:n[n.length-1],children:e.doc.content.map((function(e){return a.serialiseTextNode(e,t.schema)})),attrs:{}};t.serialiser.attrs&&Object.entries(t.serialiser.attrs).forEach((function(e){var t=Object(p["a"])(e,2),a=t[0],n=t[1];r.attrs[a]?r.attrs[a].push(n):r.attrs[a]=[n]})),Object.entries(this.nested).forEach((function(n){var i=Object(p["a"])(n,2),o=i[0],s=i[1];new Set(s).forEach((function(n){e.nested[o]&&e.nested[o][n]&&r.children.push(a.serialiseTextNode(e.nested[o][n],t.schema))}))}));for(var i=n.length-2;i>=0;i--)r={node:n[i],children:[r]};return{node:"tei:TEI",children:[r]}}return null}},{key:"serialiseTextNode",value:function(e,t){var a=this,n=t.filter((function(t){return t.name===e.type&&t.serialiser}));if(1===n.length){n=n[0];var r={node:n.serialiser.tag,attrs:{},children:[],text:null};if(n.serialiser.attrs&&Object.entries(n.serialiser.attrs).forEach((function(e){r.attrs[e[0]]=[e[1]]})),e.attrs&&Object.entries(e.attrs).forEach((function(e){var t=n.attrs[e[0]].serialiser;if(t){var a=void 0;t.values?t.values[e[1]]&&(a=t.values[e[1]]):a=t.value?t.value.replace("{value}",e[1]):e[1],void 0!==a&&("text()"===t.attr?r.text=a:r.attrs[t.attr]?r.attrs[t.attr].push(a):r.attrs[t.attr]=[a])}})),"inline"===n.type){if(e.content)if(e.content.length>1||e.content[0].marks&&e.content[0].marks.length>0)e.content.forEach((function(e){r.children.push(a.serialiseTextNode(e,t))}));else{var i=this.serialiseTextNode(e.content[0],t);n.serialiser.text?r.attrs[n.serialiser.text.attr]?r.attrs[n.serialiser.text.attr].push(i.text):r.attrs[n.serialiser.text.attr]=[i.text]:r.text=i.text}else e.text&&(n.serialiser.text?r.attrs[n.serialiser.text.attr]?r.attrs[n.serialiser.text.attr].push(e.text):r.attrs[n.serialiser.text.attr]=[e.text]:r.text=e.text);if(e.marks){var o=e.marks.map((function(e){var a=t.filter((function(t){return t.name===e.type&&t.serialiser}));if(1===a.length){a=a[0];var n={node:r.node,attrs:{}},i=a.serialiser;return i.tag&&(n.node=i.tag),i.attrs&&Object.entries(i.attrs).forEach((function(e){e[1].value&&(n.attrs[e[0]]?n.attrs[e[0]].push(e[1].value):n.attrs[e[0]]=[e[1].value])})),e.attrs&&Object.entries(e.attrs).forEach((function(e){var t=void 0;a.attrs[e[0]].serialiser.value?t=a.attrs[e[0]].serialiser.value.replace("{value}",e[1]):a.attrs[e[0]].serialiser.values&&a.attrs[e[0]].serialiser.values[e[1]]&&(t=a.attrs[e[0]].serialiser.values[e[1]]),void 0!==t&&(n.attrs[a.attrs[e[0]].serialiser.attr]?n.attrs[a.attrs[e[0]].serialiser.attr].push(t):n.attrs[a.attrs[e[0]].serialiser.attr]=[t])})),n}return null})).filter((function(e){return e}));if(new Set(o.map((function(e){return e.node}))).size>1){o.sort((function(e,t){return e.node<t.node?-1:e.node>t.node?1:e.node===t.node?0:void 0}));var s=r;s.node=null,o.forEach((function(e){if(null===s.node||s.node===e.node)s.node=e.node,Object.entries(e.attrs).forEach((function(e){s.attrs[e[0]]?s.attrs[e[0]]=s.attrs[e[0]].concat(e[1]):s.attrs[e[0]]=e[1]}));else{var t={node:e.node,attrs:e.attrs,children:[],text:s.text};s.text=null,s.children.push(t),s=t}}))}else o.forEach((function(e){e&&(e.node&&(r.node=e.node),e.attrs&&Object.entries(e.attrs).forEach((function(e){r.attrs[e[0]]?r.attrs[e[0]]=r.attrs[e[0]].concat(e[1]):r.attrs[e[0]]=e[1]})))}))}}else e.content&&e.content.forEach((function(e){"doc"===e.type?e.content&&e.content.forEach((function(e){r.children.push(a.serialiseTextNode(e,t))})):r.children.push(a.serialiseTextNode(e,t))}));return n.reference&&(this.nested[n.reference.type]||(this.nested[n.reference.type]=[]),this.nested[n.reference.type].push(e.attrs[n.reference.attr])),r.children.length>0||r.text||Object.keys(r.attrs).length>0?r:null}return null}},{key:"serialiseHeader",value:function(e,t){var a=this;return{node:"tei:TEI",children:[{node:"tei:teiHeader",children:t.schema.map((function(t){return a.serialiseMetadataNode(e[t.tag.substring(4)],t)}))}]}}},{key:"serialiseMetadataNode",value:function(e,t){var a=this;if(t.multiple){var n=e.map((function(e){var n={node:t.tag};if(e._text&&(n.text=e._text),e._attrs&&(n.attrs={},Object.entries(e._attrs).forEach((function(e){n.attrs[e[0]]=[e[1]]}))),t.children){n.children=[];for(var r=0;r<t.children.length;r++)if(e[t.children[r].tag.substring(4)]){var i=a.serialiseMetadataNode(e[t.children[r].tag.substring(4)],t.children[r]);Array.isArray(i)?n.children=n.children.concat(i):n.children.push(i)}}return n}));return n}var r={node:t.tag};if(e&&(e._text&&(r.text=e._text),e._attrs&&(r.attrs={},Object.entries(e._attrs).forEach((function(e){r.attrs[e[0]]=[e[1]]}))),t.children)){r.children=[];for(var i=0;i<t.children.length;i++)if(e[t.children[i].tag.substring(4)]){var o=this.serialiseMetadataNode(e[t.children[i].tag.substring(4)],t.children[i]);Array.isArray(o)?r.children=r.children.concat(o):r.children.push(o)}}return r}},{key:"toString",value:function(e,t){var a=this;function n(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var r=[];if(e){var i=[t,"<",e.node];e.attrs&&Object.entries(e.attrs).forEach((function(e){e[1].length>0&&(e[1].sort(),i.push(" "+e[0]+'="'+n(e[1].join(" "))+'"'))})),e.children&&e.children.length>0?(i.push(">"),r.push(i.join("")),e.children.forEach((function(e){r=r.concat(a.toString(e,t+"  "))})),r.push(t+"</"+e.node+">")):(e.text?(i.push(">"),i.push(n(e.text)),i.push("</"+e.node+">")):i.push("/>"),r.push(i.join("")))}return r}}]),e}()),Ne=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.currentSection=null,e.textData={},e.metadata={},e}return Object(s["a"])(a,[{key:"mounted",value:function(){this.currentSection=Object.keys(this.config.sections)[0],this.autoLoadCallback&&this.autoLoadCallback(this.loadData)}},{key:"setCurrentSection",value:function(e){this.currentSection=e}},{key:"save",value:function(){var e=new Ae,t=Object(v["a"])({metadata:this.metadata},this.textData);this.$emit("save",e.serialise(t,this.config.sections))}},{key:"load",value:function(){this.loadCallback&&this.loadCallback(this.loadData)}},{key:"loadData",value:function(e){var t=this,a=new DOMParser,n=a.parseFromString(e,"application/xml");this.metadata={},this.textData={},Object.entries(this.config.sections).forEach((function(e){var a=Object(p["a"])(e,2),r=a[0],i=a[1];if("MetadataEditor"===i.type)t.metadata=new je(n,i).get();else if("TextEditor"===i.type){var o=new Te(n,i).get(),s=Object(p["a"])(o,2),c=s[0],l=s[1];d["c"].set(t.textData,r,{doc:c,nested:l})}}))}}]),a}(d["c"]);u["a"]([Object(d["b"])()],Ne.prototype,"config",void 0),u["a"]([Object(d["b"])()],Ne.prototype,"autoLoadCallback",void 0),u["a"]([Object(d["b"])()],Ne.prototype,"loadCallback",void 0),Ne=u["a"]([Object(d["a"])({components:{AriaMenubar:N,AriaMenu:D,TextEditor:ke,MetadataEditor:Y}})],Ne);var Me=Ne,Ee=Me,Se=(a("e215"),Object(j["a"])(Ee,h,f,!1,null,null,null)),we=Se.exports,_e=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.config=null,e}return Object(s["a"])(a,[{key:"mounted",value:function(){var e=document.getElementById("TEIEditorConfig");if(e){var t=JSON.parse(e.innerHTML);t&&(this.config=t)}}},{key:"autoLoad",value:function(e){var t=document.getElementById("TEIEditorDocument");t&&e(t.innerHTML)}},{key:"load",value:function(e){var t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("class","hidden");var a=document.querySelector("body");a&&(a.appendChild(t),t.click(),t.addEventListener("change",(function(a){if(a.target){var n=a.target.files;if(n&&n.length>0){var r=new FileReader;r.onload=function(t){t.target&&e(t.target.result)},r.readAsText(n[0])}}t.remove()})))}},{key:"save",value:function(e){var t=new Blob([e],{type:"text/xml;charset=utf-8"}),a=document.createElement("a");a.setAttribute("href",URL.createObjectURL(t)),a.setAttribute("download","download.tei"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}}]),a}(d["c"]);_e=u["a"]([Object(d["a"])({components:{TeiEditor:we}})],_e);var Ce=_e,De=Ce,Ve=Object(j["a"])(De,r,i,!1,null,null,null),Le=Ve.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(Le)}}).$mount("#app")},e215:function(e,t,a){"use strict";var n=a("ba8f"),r=a.n(n);r.a}});
//# sourceMappingURL=app.js.map